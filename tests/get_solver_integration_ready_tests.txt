Trying to make or-tools summonable by a higher level module (as in it uses or-tools as a sub-solver) in python.

This is  a log of command line inputs and outputs.
Each subsequent program is a duplicate of the previous, with some changes.

 As my basis CVRP program, I used the Python version of the complete program found here: https://developers.google.com/optimization/routing/cvrp
Technically the final product has two capacities - demand and vehicle fuel - but we only deal with demand for now.

First, let's check that python is working:
--------------------------------------------------------------------------
C:\Users\jc321076\github\or-tools>python tests/example_routing.py
Route for vehicle 0:
 0 ->  8 ->  6 ->  2 ->  5 -> 0
Distance of the route: 1552m

Route for vehicle 1:
 0 ->  7 ->  1 ->  4 ->  3 -> 0
Distance of the route: 1552m

Route for vehicle 2:
 0 ->  9 ->  10 ->  16 ->  14 -> 0
Distance of the route: 1552m

Route for vehicle 3:
 0 ->  12 ->  11 ->  15 ->  13 -> 0
Distance of the route: 1552m

Maximum of the route distances: 1552m

--------------------------------------------------------------------------


Okay, that works. Now, let's do the same but for the CVRP:
--------------------------------------------------------------------------
C:\Users\jc321076\github\or-tools>python tests/external_data_routing.py
Route for vehicle 0:
 0 Load(0) ->  1 Load(1) ->  4 Load(5) ->  3 Load(7) ->  15 Load(15) ->  0 Load(15)
Distance of the route: 2192m
Load of the route: 15

Route for vehicle 1:
 0 Load(0) ->  14 Load(4) ->  16 Load(12) ->  10 Load(14) ->  2 Load(15) ->  0 Load(15)
Distance of the route: 2192m
Load of the route: 15

Route for vehicle 2:
 0 Load(0) ->  7 Load(8) ->  13 Load(12) ->  12 Load(14) ->  11 Load(15) ->  0 Load(15)
Distance of the route: 1324m
Load of the route: 15

Route for vehicle 3:
 0 Load(0) ->  9 Load(1) ->  8 Load(9) ->  6 Load(13) ->  5 Load(15) ->  0 Load(15)
Distance of the route: 1164m
Load of the route: 15

Total distance of all routes: 6872m
Total load of all routes: 60

--------------------------------------------------------------------------


Can we solve external_data_routing.py when located outside the or-tools folder?
--------------------------------------------------------------------------
C:\Users\jc321076\github>python external_data_routing.py
Route for vehicle 0:
 0 Load(0) ->  1 Load(1) ->  4 Load(5) ->  3 Load(7) ->  15 Load(15) ->  0 Load(15)
Distance of the route: 2192m
Load of the route: 15

Route for vehicle 1:
 0 Load(0) ->  14 Load(4) ->  16 Load(12) ->  10 Load(14) ->  2 Load(15) ->  0 Load(15)
Distance of the route: 2192m
Load of the route: 15

Route for vehicle 2:
 0 Load(0) ->  7 Load(8) ->  13 Load(12) ->  12 Load(14) ->  11 Load(15) ->  0 Load(15)
Distance of the route: 1324m
Load of the route: 15

Route for vehicle 3:
 0 Load(0) ->  9 Load(1) ->  8 Load(9) ->  6 Load(13) ->  5 Load(15) ->  0 Load(15)
Distance of the route: 1164m
Load of the route: 15

Total distance of all routes: 6872m
Total load of all routes: 60

--------------------------------------------------------------------------


Seems so! What if we move the file to a completely different location?
--------------------------------------------------------------------------
C:\Users\jc321076\Documents>python external_data_routing.py
Route for vehicle 0:
 0 Load(0) ->  1 Load(1) ->  4 Load(5) ->  3 Load(7) ->  15 Load(15) ->  0 Load(15)
Distance of the route: 2192m
Load of the route: 15

Route for vehicle 1:
 0 Load(0) ->  14 Load(4) ->  16 Load(12) ->  10 Load(14) ->  2 Load(15) ->  0 Load(15)
Distance of the route: 2192m
Load of the route: 15

Route for vehicle 2:
 0 Load(0) ->  7 Load(8) ->  13 Load(12) ->  12 Load(14) ->  11 Load(15) ->  0 Load(15)
Distance of the route: 1324m
Load of the route: 15

Route for vehicle 3:
 0 Load(0) ->  9 Load(1) ->  8 Load(9) ->  6 Load(13) ->  5 Load(15) ->  0 Load(15)
Distance of the route: 1164m
Load of the route: 15

Total distance of all routes: 6872m
Total load of all routes: 60

--------------------------------------------------------------------------


Yup, seems to work! Okay, now I  want to summon both or-tools and VRPModelling in separate folder.
I moved external_data_routing.py back into the github folder that contains both or-tools and VRPModelling folders.
I changed the number for vehicles from 4 to 1:
--------------------------------------------------------------------------
C:\Users\jc321076\github>python external_data_routing.py

C:\Users\jc321076\github>

--------------------------------------------------------------------------


It spend maybe 5 minutes running and did not produce anything.
It seems that or-tools doesn't by default understand "one vehicle making multiple routes".
For now, we can workaround it by having lots of dummy vehicles, each one representing a trip made by the single vehicle.

  data['vehicle_capacities'] = [15, 15, 15, 15, 15, 15, 15, 15, 15, 15]  # TODO: make this dependent on num of vehicles for bandaid
    data['num_vehicles'] = 10  # larger number, higher than the number of routes

This won't work for a dynamic case, because events turn up on a timeline.
Anyway, I'll use the workaround for now and deal with it at the dynamic stage.
--------------------------------------------------------------------------
C:\Users\jc321076\github>python external_data_routing.py
Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  1 Load(1) ->  4 Load(5) ->  3 Load(7) ->  15 Load(15) ->  0 Load(15)
Distance of the route: 2192m
Load of the route: 15

Route for vehicle 2:
 0 Load(0) ->  14 Load(4) ->  16 Load(12) ->  10 Load(14) ->  2 Load(15) ->  0 Load(15)
Distance of the route: 2192m
Load of the route: 15

Route for vehicle 3:
 0 Load(0) ->  7 Load(8) ->  13 Load(12) ->  12 Load(14) ->  11 Load(15) ->  0 Load(15)
Distance of the route: 1324m
Load of the route: 15

Route for vehicle 4:
 0 Load(0) ->  9 Load(1) ->  8 Load(9) ->  6 Load(13) ->  5 Load(15) ->  0 Load(15)
Distance of the route: 1164m
Load of the route: 15

Total distance of all routes: 6872m
Total load of all routes: 60

--------------------------------------------------------------------------


There is an extra empty route there, so I know there are enough dummy vehicles assigned.

Now, I want to import my VRPModeling classes into external_data_routing.py:

  from VRPModeling.Depot import Depot
  depot1 = Depot(0, [0, 0])
  print(depot1.__str__())

I comment out the print_solution() command so the output is less cluttered.
Running it:
--------------------------------------------------------------------------
C:\Users\jc321076\github>python external_data_routing.py
Traceback (most recent call last):
  File "external_data_routing.py", line 8, in <module>
    from VRPModeling.Depot import Depot
  File "C:\Users\jc321076\github\VRPModeling\Depot.py", line 1, in <module>
    from Node import Node
ModuleNotFoundError: No module named 'Node'

--------------------------------------------------------------------------


So the issue isn't the first import, but the import line within Depoty.py, because it assumes Node.py is in the same folder, but external_data_routing.py doesn't know where Node.py is.
According to this stack overflow answer, we can use a relative reference to fix this:
https://stackoverflow.com/questions/40397851/python-cant-find-a-module-that-is-imported-in-another-module
I modify Depot.py in VRPModeling:

  from .Node import Node

And run again:
--------------------------------------------------------------------------
C:\Users\jc321076\github>python external_data_routing.py
Depot.id = 0
Depot.location = [0, 0]
--------------------------------------------------------------------------


Excellent. I modify all imports in VRPModeling classes to a relative reference.
Then I create add more objects needed for a VRP instance (just the dummy instance found in VRPModeling's sandbox):

  from Vehicle import Vehicle
  vehicle1 = Vehicle(11, 0.8)
  print(vehicle1.__str__())

  from VRPInstance import VRPInstance
  vrp1 = VRPInstance(vehicle1, depot1)

  from Node import Node
  import random
  random.seed(7)
  for i in range(7):
      x = random.randrange(12)
      y = random.randrange(15)
      demand = random.randrange(5, 50, 5)
      vrp1.add_node([x, y], demand)
  print(vrp1.__str__())
  print(vrp1.nodes_details())

Running it:
--------------------------------------------------------------------------
C:\Users\jc321076\github>python external_data_routing.py
Depot.id = 0
Depot.location = [0, 0]
Vehicle.capacities = 11
Vehicle.variable_cost = 0.8
name = Andersen_n8
Vehicle.capacities = 11
Vehicle.variable_cost = 0.8
Depot.id = 0
Depot.location = [0, 0]
nodes in instance: 7
arcs in instance: 7
id    location    demand
1     [5, 2]      35
2     [10, 0]      10
3     [8, 1]      30
4     [9, 0]      45
5     [3, 0]      10
6     [6, 6]      10
7     [3, 1]      45

--------------------------------------------------------------------------


Now I want VRPModeling to spit out data that is digestible by or-tools.
I created a function called get_distance_matrix() in VRPInstance.
I want to store the distance matrix as a sparse matrix since not all nodes will necessarily have arcs connecting them.
I'm assuming that numpy's array is best for the job, but happy to change if not the case.

...I just realised that or-tools doesn't actually need a distance matrix.
It uses a distance callback - in the example program, it is defined as below:

  def distance_callback(from_index, to_index):
      """Returns the distance between the two nodes.
      Basically the way the system internally accesses the distance matrix
      """

      # Convert from routing variable Index to distance matrix NodeIndex.
      from_node = manager.IndexToNode(from_index)
      to_node = manager.IndexToNode(to_index)
      return data['distance_matrix'][from_node][to_node]

So I can redefine the distance callback to pull distances straight from VRPInstance's arcs list, instead from a distance matrix!
(I also refactored Node.id as an int, and arcs keys as the Node id)
The new redefinition:

  def distance_callback(from_index, to_index):
      """Returns the distance between the two nodes. Distance MUST BE INTEGER!
      Distance values are scaled by 100. Note that solution printer must scale down by 100.

      Basically the way the system internally accesses the distance matrix.
      """

      # Convert from routing variable Index to distance matrix NodeIndex.
      from_node = manager.IndexToNode(from_index)
      to_node = manager.IndexToNode(to_index)
      distance = vrp_instance.arcs[from_node][to_node].distance
      distance = int(round(distance * 100))  # scaling to keep float precision
      print("distance from node {0} to node {1} is {2}\n".format(from_node, to_node, distance))

      return distance

  distance_callback(1, 2)

I call distance_callback to check that it's working.
Yes, the distance given is a scale version of the value from the distance matrix.
(remember that node 0 is the first column of the distance matrix)
--------------------------------------------------------------------------

[[ 0.          5.38516481  1.          5.09901951  8.54400375  6.08276253
   3.16227766 10.        ]
 [ 5.38516481  0.          5.09901951  5.          3.16227766  5.65685425
   4.12310563  5.        ]
 [ 1.          5.09901951  0.          4.12310563  8.24621125  5.09901951
   2.23606798  9.43398113]
 [ 5.09901951  5.          4.12310563  0.          7.28010989  1.
   2.          7.07106781]
 [ 8.54400375  3.16227766  8.24621125  7.28010989  0.          7.61577311
   7.          3.        ]
 [ 6.08276253  5.65685425  5.09901951  1.          7.61577311  0.
   3.          7.        ]
 [ 3.16227766  4.12310563  2.23606798  2.          7.          3.
   0.          7.61577311]
 [10.          5.          9.43398113  7.07106781  3.          7.
   7.61577311  0.        ]]
distance from node 1 to node 2 is 510
Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  4 Load(4) ->  3 Load(6) ->  1 Load(7) ->  0 Load(7)
Distance of the route: 0m
Load of the route: 7

Route for vehicle 4:
 0 Load(0) ->  7 Load(8) ->  6 Load(12) ->  5 Load(14) ->  2 Load(15) ->  0 Load(15)
Distance of the route: 0m
Load of the route: 15

Total distance of all routes: 0m
Total load of all routes: 22

--------------------------------------------------------------------------


But the distances given in the solution is 0! Why?
I go back to the old distance callback:
--------------------------------------------------------------------------

Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  5 Load(2) ->  6 Load(6) ->  2 Load(7) ->  1 Load(8) ->  4 Load(12) ->  3 Load(14) ->  0 Load(14)
Distance of the route: 2464m
Load of the route: 14

Route for vehicle 4:
 0 Load(0) ->  7 Load(8) ->  0 Load(8)
Distance of the route: 388m
Load of the route: 8

Total distance of all routes: 2852m
Total load of all routes: 22
[Finished in 1.764s]

--------------------------------------------------------------------------

So the old distance callback works.
Let's try putting our VRPInstance through create_data_model():.

    def create_data_model(vrp_instance):  # We can replace this with a VRPModeling structure?, or a read-in
        """Stores the data for the problem. Creates a dictionary, to be exact. """

        data = {}
        data['distance_matrix'] = vrp_instance.get_distance_matrix()
        print(data['distance_matrix'])

We print out the distance matrix to make sure it works.
--------------------------------------------------------------------------
[[ 0.          5.38516481  1.          5.09901951  8.54400375  6.08276253  3.16227766 10.        ]
 [ 5.38516481  0.          5.09901951  5.          3.16227766  5.65685425  4.12310563  5.        ]
 [ 1.          5.09901951  0.          4.12310563  8.24621125  5.09901951  2.23606798  9.43398113]
 [ 5.09901951  5.          4.12310563  0.          7.28010989  1.          2.          7.07106781]
 [ 8.54400375  3.16227766  8.24621125  7.28010989  0.          7.61577311  7.          3.        ]
 [ 6.08276253  5.65685425  5.09901951  1.          7.61577311  0.          3.          7.        ]
 [ 3.16227766  4.12310563  2.23606798  2.          7.          3.          0.          7.61577311]
 [10.          5.          9.43398113  7.07106781  3.          7.          7.61577311  0.        ]]
Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  1 Load(1) ->  4 Load(5) ->  7 Load(13) ->  0 Load(13)
Distance of the route: 21m
Load of the route: 13

Route for vehicle 4:
 0 Load(0) ->  2 Load(1) ->  6 Load(5) ->  3 Load(7) ->  5 Load(9) ->  0 Load(9)
Distance of the route: 12m
Load of the route: 9

Total distance of all routes: 33m
Total load of all routes: 22
[Finished in 0.398s]
--------------------------------------------------------------------------

Hm. The distance still shows.
More interestingly the solution is different from when the distance callback used arcs.
Is it because distance matrix values are floats?
or-tools supposedly needs integer values, but it seems to produce a solution anyway?
Let's try scaling and rounding to an integer:

data['distance_matrix'] = np.rint(vrp_instance.get_distance_matrix() * 100)

The solution might change due to precision:
--------------------------------------------------------------------------

[[   0.  539.  100.  510.  854.  608.  316. 1000.]
 [ 539.    0.  510.  500.  316.  566.  412.  500.]
 [ 100.  510.    0.  412.  825.  510.  224.  943.]
 [ 510.  500.  412.    0.  728.  100.  200.  707.]
 [ 854.  316.  825.  728.    0.  762.  700.  300.]
 [ 608.  566.  510.  100.  762.    0.  300.  700.]
 [ 316.  412.  224.  200.  700.  300.    0.  762.]
 [1000.  500.  943.  707.  300.  700.  762.    0.]]
Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  1 Load(1) ->  4 Load(5) ->  7 Load(13) ->  0 Load(13)
Distance of the route: 2155m
Load of the route: 13

Route for vehicle 4:
 0 Load(0) ->  6 Load(4) ->  3 Load(6) ->  5 Load(8) ->  2 Load(9) ->  0 Load(9)
Distance of the route: 1226m
Load of the route: 9

Total distance of all routes: 3381m
Total load of all routes: 22
[Finished in 0.469s]

--------------------------------------------------------------------------


Okay, weird. The solution did change slightly.
But it's really similar to the previous solution, with the same nodes in each route.
Just the order in the second route is swapped around.
It's still not similar to the arcs distance callback though.

I want to directly pull the distances from arcs instead of having to got through the get_distance_matrix() function.
A thought: VRPInstance.arcs doesn't actually store arcs going from a node to itself.
Distance matrices on the other hand store zeros on the diagonal. Does that matter?

    def distance_callback(from_index, to_index):

        # Convert from routing variable Index to distance matrix NodeIndex.
        from_node = manager.IndexToNode(from_index)
        to_node = manager.IndexToNode(to_index)
        if from_node == to_node:
            distance = 0
        else:
            distance = (vrp_instance.arcs[from_node][to_node]).distance
            distance = round(distance * 100)
        return distance

Now:
--------------------------------------------------------------------------

Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  1 Load(1) ->  4 Load(5) ->  7 Load(13) ->  0 Load(13)
Distance of the route: 2155m
Load of the route: 13

Route for vehicle 4:
 0 Load(0) ->  6 Load(4) ->  3 Load(6) ->  5 Load(8) ->  2 Load(9) ->  0 Load(9)
Distance of the route: 1226m
Load of the route: 9

Total distance of all routes: 3381m
Total load of all routes: 22
[Finished in 0.433s]

--------------------------------------------------------------------------


Yes! It was the zeroes!
The solution is the same as the old distance callback on the VRPInstance.
But showing the distance this time.
The bug is fixed!

I want to get rid of create_data_model() completely and transfer everything to create_random_vrp_instance().
The next task is to extract demands directly from vrp_instance.nodes[index].demand

    # Add Capacity constraint
    def demand_callback(from_index):
        "Returns the demand of the node"
        # Convert from routing variable Index to demands NodeIndex
        from_node = manager.IndexToNode(from_index)
        return data['demands'][from_node]
        return demand

Changed to:

        def demand_callback(from_index):
            from_node = manager.IndexToNode(from_index)
            demand = vrp_instance.nodes[from_node].demand
            print(demand)
            return demand

And the one reference in the solution printer is adjusted:

    route_load += vrp_instance.nodes[node_index].demand

I print the demand so we can see if it extract it properly:
--------------------------------------------------------------------------
id    location    demand
0     [0, 0]      0
1     [5, 2]      35
2     [0, 1]      45
3     [1, 5]      5
4     [8, 3]      5
5     [1, 6]      35
6     [1, 3]      10
7     [8, 6]      5
0
35
45
5
5
35
10
5
45
....
0
45
0
35
[Finished in 0.569s]
--------------------------------------------------------------------------


It extracts properly, but doesn't print out the solution?
Ah! What if there is no possible solution because the vehicle capacities are too small:

  data['vehicle_capacities'] = [15, 15, 15, 15, 15]

Let's reduce the demand range to 15 when we generate the demand in create_random_vrp_instance():

    demand = random.randrange(1, 15, 1)

Aaaaand:
--------------------------------------------------------------------------
id    location    demand
0     [0, 0]      0
1     [5, 2]      7
2     [0, 1]      14
3     [8, 1]      6
4     [9, 0]      9
5     [3, 0]      2
6     [6, 6]      2
7     [3, 1]      9
[0, 7, 14, 6, 9, 2, 2, 9]
Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  3 Load(6) ->  4 Load(15) ->  0 Load(15)
Distance of the route: 1847m
Load of the route: 15

Route for vehicle 2:
 0 Load(0) ->  6 Load(2) ->  1 Load(9) ->  5 Load(11) ->  0 Load(11)
Distance of the route: 1844m
Load of the route: 11

Route for vehicle 3:
 0 Load(0) ->  7 Load(9) ->  0 Load(9)
Distance of the route: 632m
Load of the route: 9

Route for vehicle 4:
 0 Load(0) ->  2 Load(14) ->  0 Load(14)
Distance of the route: 200m
Load of the route: 14

Total distance of all routes: 4523m
Total load of all routes: 49
[Finished in 0.424s]

--------------------------------------------------------------------------


Next I want to get rid of data['vehicle_capacities'] and extract that number straight from create_random_vrp_instance():

  from VRPModeling.Vehicle import Vehicle
    vehicle1 = Vehicle(15)

Since my problem only has 1 vehicle with one capacity, we don't need the vector of vehicle capacities as found in the original:

    demand_callback_index = routing.RegisterUnaryTransitCallback(demand_callback)
      routing.AddDimensionWithVehicleCapacity(
          demand_callback_index,
          0,  # null capacity slack
          data['vehicle_capacities'],
          True,  # start culum to zero
          'Capacity')

Instead of AddDimensionWithVehicleCapacity(), we can just use AddDimension() with a single upper bound capacity:

    demand_callback_index = routing.RegisterUnaryTransitCallback(demand_callback)
    routing.AddDimension(
        demand_callback_index,
        0,  # null capacity slack https://developers.google.com/optimization/routing/dimensions#slack_variables
        vrp_instance.vehicle.capacity,
        True,  # start culum to zero
        'Capacity')

This should give us the same solution.
--------------------------------------------------------------------------

Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  3 Load(6) ->  4 Load(15) ->  0 Load(15)
Distance of the route: 1847m
Load of the route: 15

Route for vehicle 2:
 0 Load(0) ->  6 Load(2) ->  1 Load(9) ->  5 Load(11) ->  0 Load(11)
Distance of the route: 1844m
Load of the route: 11

Route for vehicle 3:
 0 Load(0) ->  7 Load(9) ->  0 Load(9)
Distance of the route: 632m
Load of the route: 9

Route for vehicle 4:
 0 Load(0) ->  2 Load(14) ->  0 Load(14)
Distance of the route: 200m
Load of the route: 14
Total distance of all routes: 4523m
Total load of all routes: 49
[Finished in 0.4s]

--------------------------------------------------------------------------


Yep!
Okay, now I want to load a toy VRP instance file using import_from_vrp_file() from FileProcessor in external_data_routing.py :

    def import_vrp_instance_from_file(absolute_path):
        from VRPModeling.FileProcessor import FileProcessor
        proc = FileProcessor()
        vrp_instance = proc.import_from_vrp_file(absolute_path)

        return vrp_instance

I choose to load up Andersen_n8. I changed the vehicle capacity of Andersen_n8 from 11 to 50, since the highest node demand is 45.
--------------------------------------------------------------------------

NAME : Andersen_n8

TYPE : CVRP

DIMENSION : 8

EDGE_WEIGHT_TYPE : EUC_2D

CAPACITY : 50

id    location    demand
0     [0, 0]      0
1     [5, 13]      5
2     [9, 4]      15
3     [1, 0]      15
4     [8, 3]      20
5     [4, 10]      25
6     [10, 4]      45
7     [1, 1]      35
Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  1 Load(5) ->  5 Load(30) ->  0 Load(30)
Distance of the route: 2786m
Load of the route: 30

Route for vehicle 2:
 0 Load(0) ->  6 Load(45) ->  0 Load(45)
Distance of the route: 2154m
Load of the route: 45

Route for vehicle 3:
 0 Load(0) ->  3 Load(15) ->  4 Load(35) ->  2 Load(50) ->  0 Load(50)
Distance of the route: 1988m
Load of the route: 50

Route for vehicle 4:
 0 Load(0) ->  7 Load(35) ->  0 Load(35)
Distance of the route: 282m
Load of the route: 35

Total distance of all routes: 7210m
Total load of all routes: 160
[Finished in 0.431s]

--------------------------------------------------------------------------


Hm. So I now have 2 issues:
1. The vehicle capacity needs to always be greater than the largest node demand.
Otherwise, or-tools will refuse to solve.
2. The number of vehicles need to be greater than the number of routes required.
Otherwise, again, or-tools won't produce a solution.
(Note that there is only one vehicle, and having several 'dummy vehicles' simply represents multiple trips at this point)

I think I will solve issue 1. by not allowing VRPInstance to add_node(demand) if the demand > vehicle capacity.
I changed the vehicle capacity of Andersen_n8 to 30:
--------------------------------------------------------------------------
NAME : Andersen_n8

TYPE : CVRP

DIMENSION : 8

EDGE_WEIGHT_TYPE : EUC_2D

CAPACITY : 30

Node at location [10, 4] could not be added because demand 45 is greater than vehicle capacity 30
Node at location [1, 1] could not be added because demand 35 is greater than vehicle capacity 30
id    location    demand
0     [0, 0]      0
1     [5, 13]      5
2     [9, 4]      15
3     [1, 0]      15
4     [8, 3]      20
5     [4, 10]      25
Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  1 Load(5) ->  5 Load(30) ->  0 Load(30)
Distance of the route: 2786m
Load of the route: 30

Route for vehicle 3:
 0 Load(0) ->  4 Load(20) ->  0 Load(20)
Distance of the route: 1708m
Load of the route: 20

Route for vehicle 4:
 0 Load(0) ->  3 Load(15) ->  2 Load(30) ->  0 Load(30)
Distance of the route: 1979m
Load of the route: 30

Total distance of all routes: 6473m
Total load of all routes: 80
[Finished in 0.401s]

--------------------------------------------------------------------------


Hm. It may be a pain to print out "Node at location [bla, bla] could not be added...."
every single time, especially if a large number of nodes can't be added.
We don't want to flood the output.
Consider a debug mode?

Okay, now I want to solve a benchmark problem:
"C:/Users/jc321076/Documents/PhD/github/Autonomous_DSVRP/Instances/Vrp-Set-X/Vrp-Set-X/Vrp-Set-X/X/X-n101-k25.vrp"

I don't know how many routes we'll need, but the number of vehicles is 25, so I'll set num_vehicles to 30.
--------------------------------------------------------------------------
NAME : 	X-n101-k25

COMMENT : 	"Generated by Uchoa, Pecin, Pessoa, Poggi, Subramanian, and Vidal (2013)"

TYPE : 	CVRP

DIMENSION : 	101

EDGE_WEIGHT_TYPE : 	EUC_2D

CAPACITY : 	206

Route for vehicle 0:
 0 Load(0) ->  98 Load(51) ->  89 Load(69) ->  47 Load(80) ->  29 Load(84) ->  36 Load(181) ->  72 Load(197) ->  57 Load(205) ->  0 Load(205)
Distance of the route: 211524m
Load of the route: 205

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 4:
 0 Load(0) ->  18 Load(81) ->  4 Load(151) ->  39 Load(178) ->  0 Load(178)
Distance of the route: 101298m
Load of the route: 178

Route for vehicle 5:
 0 Load(0) ->  87 Load(2) ->  43 Load(17) ->  45 Load(31) ->  2 Load(82) ->  7 Load(83) ->  13 Load(129) ->  74 Load(202) ->  0 Load(202)
Distance of the route: 222501m
Load of the route: 202

Route for vehicle 6:
 0 Load(0) ->  14 Load(27) ->  6 Load(81) ->  37 Load(151) ->  49 Load(204) ->  0 Load(204)
Distance of the route: 153432m
Load of the route: 204

Route for vehicle 7:
 0 Load(0) ->  92 Load(68) ->  9 Load(130) ->  86 Load(203) ->  0 Load(203)
Distance of the route: 134427m
Load of the route: 203

Route for vehicle 8:
 0 Load(0) ->  51 Load(80) ->  62 Load(118) ->  99 Load(196) ->  0 Load(196)
Distance of the route: 131452m
Load of the route: 196

Route for vehicle 9:
 0 Load(0) ->  1 Load(38) ->  70 Load(134) ->  54 Load(201) ->  0 Load(201)
Distance of the route: 145608m
Load of the route: 201

Route for vehicle 10:
 0 Load(0) ->  66 Load(46) ->  84 Load(89) ->  90 Load(144) ->  68 Load(196) ->  0 Load(196)
Distance of the route: 120459m
Load of the route: 196

Route for vehicle 11:
 0 Load(0) ->  71 Load(18) ->  83 Load(114) ->  52 Load(201) ->  0 Load(201)
Distance of the route: 122076m
Load of the route: 201

Route for vehicle 12:
 0 Load(0) ->  38 Load(32) ->  48 Load(125) ->  3 Load(198) ->  64 Load(201) ->  34 Load(206) ->  0 Load(206)
Distance of the route: 123972m
Load of the route: 206

Route for vehicle 13:
 0 Load(0) ->  25 Load(53) ->  10 Load(151) ->  28 Load(183) ->  0 Load(183)
Distance of the route: 100658m
Load of the route: 183

Route for vehicle 14:
 0 Load(0) ->  65 Load(5) ->  78 Load(44) ->  42 Load(120) ->  63 Load(185) ->  0 Load(185)
Distance of the route: 113861m
Load of the route: 185

Route for vehicle 15:
 0 Load(0) ->  81 Load(14) ->  91 Load(89) ->  27 Load(176) ->  21 Load(199) ->  0 Load(199)
Distance of the route: 108385m
Load of the route: 199

Route for vehicle 16:
 0 Load(0) ->  59 Load(55) ->  82 Load(138) ->  77 Load(202) ->  0 Load(202)
Distance of the route: 98853m
Load of the route: 202

Route for vehicle 17:
 0 Load(0) ->  88 Load(21) ->  67 Load(121) ->  60 Load(188) ->  0 Load(188)
Distance of the route: 89996m
Load of the route: 188

Route for vehicle 18:
 0 Load(0) ->  69 Load(28) ->  16 Load(125) ->  55 Load(197) ->  76 Load(203) ->  0 Load(203)
Distance of the route: 136370m
Load of the route: 203

Route for vehicle 19:
 0 Load(0) ->  15 Load(17) ->  22 Load(79) ->  41 Load(146) ->  20 Load(205) ->  0 Load(205)
Distance of the route: 83842m
Load of the route: 205

Route for vehicle 20:
 0 Load(0) ->  94 Load(61) ->  40 Load(103) ->  44 Load(142) ->  58 Load(200) ->  0 Load(200)
Distance of the route: 84465m
Load of the route: 200

Route for vehicle 21:
 0 Load(0) ->  75 Load(76) ->  93 Load(176) ->  33 Load(191) ->  0 Load(191)
Distance of the route: 80718m
Load of the route: 191

Route for vehicle 22:
 0 Load(0) ->  31 Load(95) ->  73 Load(102) ->  53 Load(199) ->  0 Load(199)
Distance of the route: 84120m
Load of the route: 199

Route for vehicle 23:
 0 Load(0) ->  96 Load(40) ->  26 Load(58) ->  56 Load(108) ->  8 Load(206) ->  0 Load(206)
Distance of the route: 103443m
Load of the route: 206

Route for vehicle 24:
 0 Load(0) ->  80 Load(70) ->  17 Load(144) ->  0 Load(144)
Distance of the route: 47443m
Load of the route: 144

Route for vehicle 25:
 0 Load(0) ->  23 Load(66) ->  19 Load(128) ->  50 Load(172) ->  0 Load(172)
Distance of the route: 57573m
Load of the route: 172

Route for vehicle 26:
 0 Load(0) ->  100 Load(35) ->  61 Load(124) ->  97 Load(172) ->  0 Load(172)
Distance of the route: 74781m
Load of the route: 172

Route for vehicle 27:
 0 Load(0) ->  5 Load(58) ->  12 Load(144) ->  0 Load(144)
Distance of the route: 53412m
Load of the route: 144

Route for vehicle 28:
 0 Load(0) ->  30 Load(61) ->  85 Load(73) ->  11 Load(98) ->  79 Load(184) ->  0 Load(184)
Distance of the route: 66675m
Load of the route: 184

Route for vehicle 29:
 0 Load(0) ->  35 Load(53) ->  46 Load(96) ->  24 Load(131) ->  95 Load(155) ->  32 Load(178) ->  0 Load(178)
Distance of the route: 89156m
Load of the route: 178

Total distance of all routes: 2940500m
Total load of all routes: 5147
[Finished in 1.031s]
--------------------------------------------------------------------------


The or-tools solution has 27 routes and a total distance of 27591m.
The optimal solution of this benchmark can be seen here:
http://vrp.galgos.inf.puc-rio.br/index.php/en/plotted-instances?data=X-n101-k25
It seems that the optimal solution uses 26 routes and has a proven optimality value of 27591m total distance.

Oops! I forgot that I was scale the coordinates up in distance callback in case they weren't integer:
    distance = round(distance * 100)
I've scaled them back down in print_solution():

    scaled_route_distance = routing.GetArcCostForVehicle(previous_index, index, vehicle_id)
    route_distance += round(scaled_route_distance/100)

Which should give the same solution:
--------------------------------------------------------------------------

NAME : 	X-n101-k25

COMMENT : 	"Generated by Uchoa, Pecin, Pessoa, Poggi, Subramanian, and Vidal (2013)"

TYPE : 	CVRP

DIMENSION : 	101

EDGE_WEIGHT_TYPE : 	EUC_2D

CAPACITY : 	206

Route for vehicle 0:
 0 Load(0) ->  98 Load(51) ->  89 Load(69) ->  47 Load(80) ->  29 Load(84) ->  36 Load(181) ->  72 Load(197) ->  57 Load(205) ->  0 Load(205)
Distance of the route: 2116m
Load of the route: 205

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 4:
 0 Load(0) ->  18 Load(81) ->  4 Load(151) ->  39 Load(178) ->  0 Load(178)
Distance of the route: 1014m
Load of the route: 178

Route for vehicle 5:
 0 Load(0) ->  87 Load(2) ->  43 Load(17) ->  45 Load(31) ->  2 Load(82) ->  7 Load(83) ->  13 Load(129) ->  74 Load(202) ->  0 Load(202)
Distance of the route: 2225m
Load of the route: 202

Route for vehicle 6:
 0 Load(0) ->  14 Load(27) ->  6 Load(81) ->  37 Load(151) ->  49 Load(204) ->  0 Load(204)
Distance of the route: 1534m
Load of the route: 204

Route for vehicle 7:
 0 Load(0) ->  92 Load(68) ->  9 Load(130) ->  86 Load(203) ->  0 Load(203)
Distance of the route: 1344m
Load of the route: 203

Route for vehicle 8:
 0 Load(0) ->  51 Load(80) ->  62 Load(118) ->  99 Load(196) ->  0 Load(196)
Distance of the route: 1314m
Load of the route: 196

Route for vehicle 9:
 0 Load(0) ->  1 Load(38) ->  70 Load(134) ->  54 Load(201) ->  0 Load(201)
Distance of the route: 1455m
Load of the route: 201

Route for vehicle 10:
 0 Load(0) ->  66 Load(46) ->  84 Load(89) ->  90 Load(144) ->  68 Load(196) ->  0 Load(196)
Distance of the route: 1205m
Load of the route: 196

Route for vehicle 11:
 0 Load(0) ->  71 Load(18) ->  83 Load(114) ->  52 Load(201) ->  0 Load(201)
Distance of the route: 1220m
Load of the route: 201

Route for vehicle 12:
 0 Load(0) ->  38 Load(32) ->  48 Load(125) ->  3 Load(198) ->  64 Load(201) ->  34 Load(206) ->  0 Load(206)
Distance of the route: 1238m
Load of the route: 206

Route for vehicle 13:
 0 Load(0) ->  25 Load(53) ->  10 Load(151) ->  28 Load(183) ->  0 Load(183)
Distance of the route: 1005m
Load of the route: 183

Route for vehicle 14:
 0 Load(0) ->  65 Load(5) ->  78 Load(44) ->  42 Load(120) ->  63 Load(185) ->  0 Load(185)
Distance of the route: 1139m
Load of the route: 185

Route for vehicle 15:
 0 Load(0) ->  81 Load(14) ->  91 Load(89) ->  27 Load(176) ->  21 Load(199) ->  0 Load(199)
Distance of the route: 1085m
Load of the route: 199

Route for vehicle 16:
 0 Load(0) ->  59 Load(55) ->  82 Load(138) ->  77 Load(202) ->  0 Load(202)
Distance of the route: 989m
Load of the route: 202

Route for vehicle 17:
 0 Load(0) ->  88 Load(21) ->  67 Load(121) ->  60 Load(188) ->  0 Load(188)
Distance of the route: 900m
Load of the route: 188

Route for vehicle 18:
 0 Load(0) ->  69 Load(28) ->  16 Load(125) ->  55 Load(197) ->  76 Load(203) ->  0 Load(203)
Distance of the route: 1364m
Load of the route: 203

Route for vehicle 19:
 0 Load(0) ->  15 Load(17) ->  22 Load(79) ->  41 Load(146) ->  20 Load(205) ->  0 Load(205)
Distance of the route: 838m
Load of the route: 205

Route for vehicle 20:
 0 Load(0) ->  94 Load(61) ->  40 Load(103) ->  44 Load(142) ->  58 Load(200) ->  0 Load(200)
Distance of the route: 844m
Load of the route: 200

Route for vehicle 21:
 0 Load(0) ->  75 Load(76) ->  93 Load(176) ->  33 Load(191) ->  0 Load(191)
Distance of the route: 808m
Load of the route: 191

Route for vehicle 22:
 0 Load(0) ->  31 Load(95) ->  73 Load(102) ->  53 Load(199) ->  0 Load(199)
Distance of the route: 841m
Load of the route: 199

Route for vehicle 23:
 0 Load(0) ->  96 Load(40) ->  26 Load(58) ->  56 Load(108) ->  8 Load(206) ->  0 Load(206)
Distance of the route: 1034m
Load of the route: 206

Route for vehicle 24:
 0 Load(0) ->  80 Load(70) ->  17 Load(144) ->  0 Load(144)
Distance of the route: 474m
Load of the route: 144

Route for vehicle 25:
 0 Load(0) ->  23 Load(66) ->  19 Load(128) ->  50 Load(172) ->  0 Load(172)
Distance of the route: 576m
Load of the route: 172

Route for vehicle 26:
 0 Load(0) ->  100 Load(35) ->  61 Load(124) ->  97 Load(172) ->  0 Load(172)
Distance of the route: 747m
Load of the route: 172

Route for vehicle 27:
 0 Load(0) ->  5 Load(58) ->  12 Load(144) ->  0 Load(144)
Distance of the route: 534m
Load of the route: 144

Route for vehicle 28:
 0 Load(0) ->  30 Load(61) ->  85 Load(73) ->  11 Load(98) ->  79 Load(184) ->  0 Load(184)
Distance of the route: 666m
Load of the route: 184

Route for vehicle 29:
 0 Load(0) ->  35 Load(53) ->  46 Load(96) ->  24 Load(131) ->  95 Load(155) ->  32 Load(178) ->  0 Load(178)
Distance of the route: 891m
Load of the route: 178

Total distance of all routes: 29400m
Total load of all routes: 5147
[Finished in 1.084s]

--------------------------------------------------------------------------


Looks like it has some effect on the accuracy...probably from the rounding.
I can amend this a little by:
1. scale by a higher magnitude to increase precision
2. descale AFTER the distances are added up.

        route_distance += routing.GetArcCostForVehicle(previous_index, index, vehicle_id)
    total_distance += route_distance
    total_load += route_load
    route_distance = round(route_distance/1000)
    plan_output += ' {0} Load({1})\n'.format(manager.IndexToNode(index), route_load)
    plan_output += 'Distance of the route: {}m\n'.format(route_distance)
    plan_output += 'Load of the route: {}\n'.format(route_load)
    print(plan_output)
total_distance = round(total_distance/1000)
print('Total distance of all routes: {}m'.format(total_distance))

The individual route distances will still be imprecise, but the final distance will be more accurate:
--------------------------------------------------------------------------

NAME : 	X-n101-k25

COMMENT : 	"Generated by Uchoa, Pecin, Pessoa, Poggi, Subramanian, and Vidal (2013)"

TYPE : 	CVRP

DIMENSION : 	101

EDGE_WEIGHT_TYPE : 	EUC_2D

CAPACITY : 	206

Route for vehicle 0:
 0 Load(0) ->  98 Load(51) ->  89 Load(69) ->  47 Load(80) ->  29 Load(84) ->  36 Load(181) ->  72 Load(197) ->  57 Load(205) ->  0 Load(205)
Distance of the route: 2115m
Load of the route: 205

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 4:
 0 Load(0) ->  18 Load(81) ->  4 Load(151) ->  39 Load(178) ->  0 Load(178)
Distance of the route: 1013m
Load of the route: 178

Route for vehicle 5:
 0 Load(0) ->  87 Load(2) ->  43 Load(17) ->  45 Load(31) ->  2 Load(82) ->  7 Load(83) ->  13 Load(129) ->  74 Load(202) ->  0 Load(202)
Distance of the route: 2225m
Load of the route: 202

Route for vehicle 6:
 0 Load(0) ->  14 Load(27) ->  6 Load(81) ->  37 Load(151) ->  49 Load(204) ->  0 Load(204)
Distance of the route: 1534m
Load of the route: 204

Route for vehicle 7:
 0 Load(0) ->  92 Load(68) ->  9 Load(130) ->  86 Load(203) ->  0 Load(203)
Distance of the route: 1344m
Load of the route: 203

Route for vehicle 8:
 0 Load(0) ->  51 Load(80) ->  62 Load(118) ->  99 Load(196) ->  0 Load(196)
Distance of the route: 1315m
Load of the route: 196

Route for vehicle 9:
 0 Load(0) ->  1 Load(38) ->  70 Load(134) ->  54 Load(201) ->  0 Load(201)
Distance of the route: 1456m
Load of the route: 201

Route for vehicle 10:
 0 Load(0) ->  66 Load(46) ->  84 Load(89) ->  90 Load(144) ->  68 Load(196) ->  0 Load(196)
Distance of the route: 1205m
Load of the route: 196

Route for vehicle 11:
 0 Load(0) ->  71 Load(18) ->  83 Load(114) ->  52 Load(201) ->  0 Load(201)
Distance of the route: 1221m
Load of the route: 201

Route for vehicle 12:
 0 Load(0) ->  38 Load(32) ->  48 Load(125) ->  3 Load(198) ->  64 Load(201) ->  34 Load(206) ->  0 Load(206)
Distance of the route: 1240m
Load of the route: 206

Route for vehicle 13:
 0 Load(0) ->  25 Load(53) ->  10 Load(151) ->  28 Load(183) ->  0 Load(183)
Distance of the route: 1007m
Load of the route: 183

Route for vehicle 14:
 0 Load(0) ->  65 Load(5) ->  78 Load(44) ->  42 Load(120) ->  63 Load(185) ->  0 Load(185)
Distance of the route: 1139m
Load of the route: 185

Route for vehicle 15:
 0 Load(0) ->  81 Load(14) ->  91 Load(89) ->  27 Load(176) ->  21 Load(199) ->  0 Load(199)
Distance of the route: 1084m
Load of the route: 199

Route for vehicle 16:
 0 Load(0) ->  59 Load(55) ->  82 Load(138) ->  77 Load(202) ->  0 Load(202)
Distance of the route: 989m
Load of the route: 202

Route for vehicle 17:
 0 Load(0) ->  88 Load(21) ->  67 Load(121) ->  60 Load(188) ->  0 Load(188)
Distance of the route: 900m
Load of the route: 188

Route for vehicle 18:
 0 Load(0) ->  69 Load(28) ->  16 Load(125) ->  55 Load(197) ->  76 Load(203) ->  0 Load(203)
Distance of the route: 1364m
Load of the route: 203

Route for vehicle 19:
 0 Load(0) ->  15 Load(17) ->  22 Load(79) ->  41 Load(146) ->  20 Load(205) ->  0 Load(205)
Distance of the route: 838m
Load of the route: 205

Route for vehicle 20:
 0 Load(0) ->  94 Load(61) ->  40 Load(103) ->  44 Load(142) ->  58 Load(200) ->  0 Load(200)
Distance of the route: 845m
Load of the route: 200

Route for vehicle 21:
 0 Load(0) ->  75 Load(76) ->  93 Load(176) ->  33 Load(191) ->  0 Load(191)
Distance of the route: 807m
Load of the route: 191

Route for vehicle 22:
 0 Load(0) ->  31 Load(95) ->  73 Load(102) ->  53 Load(199) ->  0 Load(199)
Distance of the route: 841m
Load of the route: 199

Route for vehicle 23:
 0 Load(0) ->  96 Load(40) ->  26 Load(58) ->  56 Load(108) ->  8 Load(206) ->  0 Load(206)
Distance of the route: 1034m
Load of the route: 206

Route for vehicle 24:
 0 Load(0) ->  80 Load(70) ->  17 Load(144) ->  0 Load(144)
Distance of the route: 474m
Load of the route: 144

Route for vehicle 25:
 0 Load(0) ->  23 Load(66) ->  19 Load(128) ->  50 Load(172) ->  0 Load(172)
Distance of the route: 576m
Load of the route: 172

Route for vehicle 26:
 0 Load(0) ->  100 Load(35) ->  61 Load(124) ->  97 Load(172) ->  0 Load(172)
Distance of the route: 748m
Load of the route: 172

Route for vehicle 27:
 0 Load(0) ->  5 Load(58) ->  12 Load(144) ->  0 Load(144)
Distance of the route: 534m
Load of the route: 144

Route for vehicle 28:
 0 Load(0) ->  30 Load(61) ->  85 Load(73) ->  11 Load(98) ->  79 Load(184) ->  0 Load(184)
Distance of the route: 667m
Load of the route: 184

Route for vehicle 29:
 0 Load(0) ->  35 Load(53) ->  46 Load(96) ->  24 Load(131) ->  95 Load(155) ->  32 Load(178) ->  0 Load(178)
Distance of the route: 892m
Load of the route: 178

Total distance of all routes: 29405m
Total load of all routes: 5147
[Finished in 1.047s]


--------------------------------------------------------------------------


Currently, the number of vehicles is just manually set to higher than the number of routes.
But since I won't know how many routes other VRPInstance solutions need, I'd like a way to keep the number of vehicles automatically higher.
For now, I can guarantee the number of vehicles being more than the number of routes by having at least one vehicle per node:

    num_vehicles = dim

And not printing the empty vehicle routes:

    if route_distance != 0:
        num_routes += 1
        plan_output += ' {0} Load({1})\n'.format(manager.IndexToNode(index), route_load)
        plan_output += 'Distance of the route: {}m\n'.format(route_distance)
        plan_output += 'Load of the route: {}\n'.format(route_load)
        print(plan_output)

Which prints the solution:
--------------------------------------------------------------------------

NAME : 	X-n101-k25

COMMENT : 	"Generated by Uchoa, Pecin, Pessoa, Poggi, Subramanian, and Vidal (2013)"

TYPE : 	CVRP

DIMENSION : 	101

EDGE_WEIGHT_TYPE : 	EUC_2D

CAPACITY : 	206

Route for vehicle 0:
 0 Load(0) ->  98 Load(51) ->  89 Load(69) ->  47 Load(80) ->  29 Load(84) ->  36 Load(181) ->  72 Load(197) ->  57 Load(205) ->  0 Load(205)
Distance of the route: 2115m
Load of the route: 205

Route for vehicle 75:
 0 Load(0) ->  18 Load(81) ->  4 Load(151) ->  39 Load(178) ->  0 Load(178)
Distance of the route: 1013m
Load of the route: 178

Route for vehicle 76:
 0 Load(0) ->  87 Load(2) ->  43 Load(17) ->  45 Load(31) ->  2 Load(82) ->  7 Load(83) ->  13 Load(129) ->  74 Load(202) ->  0 Load(202)
Distance of the route: 2225m
Load of the route: 202

Route for vehicle 77:
 0 Load(0) ->  14 Load(27) ->  6 Load(81) ->  37 Load(151) ->  49 Load(204) ->  0 Load(204)
Distance of the route: 1534m
Load of the route: 204

Route for vehicle 78:
 0 Load(0) ->  92 Load(68) ->  9 Load(130) ->  86 Load(203) ->  0 Load(203)
Distance of the route: 1344m
Load of the route: 203

Route for vehicle 79:
 0 Load(0) ->  51 Load(80) ->  62 Load(118) ->  99 Load(196) ->  0 Load(196)
Distance of the route: 1315m
Load of the route: 196

Route for vehicle 80:
 0 Load(0) ->  1 Load(38) ->  70 Load(134) ->  54 Load(201) ->  0 Load(201)
Distance of the route: 1456m
Load of the route: 201

Route for vehicle 81:
 0 Load(0) ->  66 Load(46) ->  84 Load(89) ->  90 Load(144) ->  68 Load(196) ->  0 Load(196)
Distance of the route: 1205m
Load of the route: 196

Route for vehicle 82:
 0 Load(0) ->  71 Load(18) ->  83 Load(114) ->  52 Load(201) ->  0 Load(201)
Distance of the route: 1221m
Load of the route: 201

Route for vehicle 83:
 0 Load(0) ->  38 Load(32) ->  48 Load(125) ->  3 Load(198) ->  64 Load(201) ->  34 Load(206) ->  0 Load(206)
Distance of the route: 1240m
Load of the route: 206

Route for vehicle 84:
 0 Load(0) ->  25 Load(53) ->  10 Load(151) ->  28 Load(183) ->  0 Load(183)
Distance of the route: 1007m
Load of the route: 183

Route for vehicle 85:
 0 Load(0) ->  65 Load(5) ->  78 Load(44) ->  42 Load(120) ->  63 Load(185) ->  0 Load(185)
Distance of the route: 1139m
Load of the route: 185

Route for vehicle 86:
 0 Load(0) ->  81 Load(14) ->  91 Load(89) ->  27 Load(176) ->  21 Load(199) ->  0 Load(199)
Distance of the route: 1084m
Load of the route: 199

Route for vehicle 87:
 0 Load(0) ->  59 Load(55) ->  82 Load(138) ->  77 Load(202) ->  0 Load(202)
Distance of the route: 989m
Load of the route: 202

Route for vehicle 88:
 0 Load(0) ->  88 Load(21) ->  67 Load(121) ->  60 Load(188) ->  0 Load(188)
Distance of the route: 900m
Load of the route: 188

Route for vehicle 89:
 0 Load(0) ->  69 Load(28) ->  16 Load(125) ->  55 Load(197) ->  76 Load(203) ->  0 Load(203)
Distance of the route: 1364m
Load of the route: 203

Route for vehicle 90:
 0 Load(0) ->  15 Load(17) ->  22 Load(79) ->  41 Load(146) ->  20 Load(205) ->  0 Load(205)
Distance of the route: 838m
Load of the route: 205

Route for vehicle 91:
 0 Load(0) ->  94 Load(61) ->  40 Load(103) ->  44 Load(142) ->  58 Load(200) ->  0 Load(200)
Distance of the route: 845m
Load of the route: 200

Route for vehicle 92:
 0 Load(0) ->  75 Load(76) ->  93 Load(176) ->  33 Load(191) ->  0 Load(191)
Distance of the route: 807m
Load of the route: 191

Route for vehicle 93:
 0 Load(0) ->  31 Load(95) ->  73 Load(102) ->  53 Load(199) ->  0 Load(199)
Distance of the route: 841m
Load of the route: 199

Route for vehicle 94:
 0 Load(0) ->  96 Load(40) ->  26 Load(58) ->  56 Load(108) ->  8 Load(206) ->  0 Load(206)
Distance of the route: 1034m
Load of the route: 206

Route for vehicle 95:
 0 Load(0) ->  80 Load(70) ->  17 Load(144) ->  0 Load(144)
Distance of the route: 474m
Load of the route: 144

Route for vehicle 96:
 0 Load(0) ->  23 Load(66) ->  19 Load(128) ->  50 Load(172) ->  0 Load(172)
Distance of the route: 576m
Load of the route: 172

Route for vehicle 97:
 0 Load(0) ->  100 Load(35) ->  61 Load(124) ->  97 Load(172) ->  0 Load(172)
Distance of the route: 748m
Load of the route: 172

Route for vehicle 98:
 0 Load(0) ->  5 Load(58) ->  12 Load(144) ->  0 Load(144)
Distance of the route: 534m
Load of the route: 144

Route for vehicle 99:
 0 Load(0) ->  30 Load(61) ->  85 Load(73) ->  11 Load(98) ->  79 Load(184) ->  0 Load(184)
Distance of the route: 667m
Load of the route: 184

Route for vehicle 100:
 0 Load(0) ->  35 Load(53) ->  46 Load(96) ->  24 Load(131) ->  95 Load(155) ->  32 Load(178) ->  0 Load(178)
Distance of the route: 892m
Load of the route: 178

Total distance of all routes: 29405m
Total load of all routes: 5147
Total number of routes: 27
[Finished in 1.234s]

--------------------------------------------------------------------------


Now I want to solve a real-life weed problem.
I use BOPMid_full_matrix.txt, which in fact is a .vrp file.
I should change that.

Unlike other VRP instances, the BOPMid_full_matrix comes with a distance matrix of weighted arcs/edges.
So first, I need to modify VRPModeling to accept an arc distance input, instead of calculating the Euclidean distance based on node locations.
The calculation occurs in the Arc init, so I it to also accept a distance input:

    def __init__(self, origin, destination, distance=None):
        """
            distance (float): distance argument if passed through, otherwise Euclidean distance of the arc path, calculated by getDistance()
        """
        self.origin = origin
        self.destination = destination
        if distance is None:
            self.distance = self.get_distance()
        else:
            self.distance = distance

I also modify VRPInstance.add_node() to accept a distance input and pass it into Arc():

    def add_node(self, location, demand, arc_distances=None):
    .
    .
    if arc_distances is None:
              for existing_node in self.nodes:
                  # Arc will calculate distance using node locations
                  new_arc = Arc(existing_node, new_node)
                  new_arc_sym = Arc(new_node, existing_node)
                  self.arcs[new_arc.origin.id][new_arc.destination.id] = new_arc
                  self.arcs[new_arc.destination.id][new_arc.origin.id] = new_arc_sym
          else:  # arc_distances inputted
              for existing_node in self.nodes:
                  new_arc = Arc(existing_node, new_node, arc_distances[existing_node.id])
                  new_arc_sym = Arc(new_node, existing_node, arc_distances[existing_node.id])
                  # print(new_arc.__str__())
                  self.arcs[new_arc.origin.id][new_arc.destination.id] = new_arc
                  self.arcs[new_arc.destination.id][new_arc.origin.id] = new_arc_sym
    .
    .

Finally, I modify FileProcessor.import_from_vrp_file() to read files containing a distance matrix:

  # determine if there is a distance matrix included
      line = vrp_file.readline()
      is_weighted = False
      weighted_distances = []
      if line.startswith('EDGE_WEIGHT_SECTION'):
          is_weighted = True
          line = vrp_file.readline()  # skip depot line
          # Assumes symmetry
          for i in range(dimension - 1):
              line = vrp_file.readline()
              distances = line.split()[:i+1]
              # print(distances)
              weighted_distances.append(distances)

          line = vrp_file.readline()  # DEMAND_SECTION
          print(line)
      else:
          print(line)  # should print DEMAND_SECTION

When run:
--------------------------------------------------------------------------

NAME: BOPMid_full_matrix

TYPE: CVRP

COMMENT: Stands for "Birds Of Prey Mid-paddock", describing the drone-surveyed area at which said birds tried to take down survey drone. Located at Redlands Park, McKinlay, QLD, Australia. Collected by Tiria Andersen, see Honours Thesis.

DIMENSION: 647

CAPACITY: 80000

EDGE_WEIGHT_TYPE: EXPLICIT

EDGE_WEIGHT_FORMAT: FULL_MATRIX

NODE_COORD_TYPE: TWOD_COORDS

DEMAND_SECTION

name = BOPMid_full_matrix
Vehicle.capacity = 80000
Vehicle.variable_cost = 0.8
Depot.id = 0
Depot.location = [0, 0]
nodes in instance, including depot: 647
arcs in instance: 417962
Total distance of all routes: 0m
Total load of all routes: 47020
Total number of routes: 0
[Finished in 3.851s]

--------------------------------------------------------------------------


It doesn't trigger any errors but or-tools find empty solutions, so something is wrong.
I need to test each of the changes in the sandbox, step by step.
But sandbox isn't running because its unhappy about relative imports, e.g. from .node import Node.

Based on this article, explicit relative imports should do what I want?
https://chrisyeh96.github.io/2017/08/08/definitive-guide-python-imports.html

Pep8 says absolute import is preferred, so absolute it is.
https://www.python.org/dev/peps/pep-0008/#imports
For example, in depot.py:

    from VRPModeling.node import Node


This thread describes the exact problem I have, so I moved sandbox.py out of VRPModeling as suggested.
https://www.reddit.com/r/learnpython/comments/9euygm/tried_to_use_relative_imports_for_library_and/

This means that any 'main' script things, even testing things, should be run outside of VRPModeling.
I've modified sandbox:

    import VRPModeling
    from VRPModeling.depot import Depot
    depot1 = Depot(0, [0, 0])

But the commented out part of sandbox still has old imports which won't work.
Anyway, I run sandbox to import the weed problem:
--------------------------------------------------------------------------

NAME: BOPMid_full_matrix

TYPE: CVRP

COMMENT: Stands for "Birds Of Prey Mid-paddock", describing the drone-surveyed area at which said birds tried to take down survey drone. Located at Redlands Park, McKinlay, QLD, Australia. Collected by Tiria Andersen, see Honours Thesis.

DIMENSION: 647

CAPACITY: 80000

EDGE_WEIGHT_TYPE: EXPLICIT

EDGE_WEIGHT_FORMAT: FULL_MATRIX

NODE_COORD_TYPE: TWOD_COORDS

DEMAND_SECTION

name = BOPMid_full_matrix
Vehicle.capacity = 80000
Vehicle.variable_cost = 0.8
Depot.id = 0
Depot.location = [0, 0]
nodes in instance, including depot: 647
arcs in instance: 417962
id    location    demand
0     [0, 0]      0
1     [124, 45]      100
2     [119, 61]      100
3     [87, 60]      50
4     [33, 95]      100
5     [35, 85]      100
6     [32, 81]      100
7     [30, 86]      100
8     [12, 61]      100
9     [16, 115]      100
10     [28, 123]      100
.
.
.
644     [602, 48]      100
645     [681, 410]      100
646     [365, 541]      100
origin -> destination
0 1 1362.13
0 2 1257.11
0 3 553.55
0 4 3740.56
0 5 3454.16
0 6 3542.03
0 7 3757.72
0 8 4107.11
0 9 5025.48
0 10 4834.06
0 11 6175.48
0 12 6556.24
0 13 6171.32
0 14 6117.77
.
.
.
0 639 18934.92
0 640 35716.86
0 641 36949.09
0 642 37523.36
0 643 0.0
0 644 0.0
0 645 36605.84
0 646 30021.17
1 0 1362.13
1 2 591.42
1 3 2010.66
1 4 5344.11
1 5 5057.72
1 6 5145.58
1 7 5361.27
1 8 5710.66
1 9 6629.04
1 10 6144.72
.
.
.
110 533 25444.57
110 534 31135.13
.
.
.
646 643 29317.01
646 644 29337.72
646 645 18250.97
[Finished in 8.871s]

--------------------------------------------------------------------------

Seems like it loads okay. So why is the solution 0m?

    print("Solver status: ", routing.status())

Will give us a solver status code according to
https://developers.google.com/optimization/routing/routing_options
Value	Description:
0	ROUTING_NOT_SOLVED: Problem not solved yet.
1	ROUTING_SUCCESS: Problem solved successfully.
2	ROUTING_FAIL: No solution found to the problem.
3	ROUTING_FAIL_TIMEOUT: Time limit reached before finding a solution.
4	ROUTING_INVALID: Model, model parameters, or flags are not valid.
--------------------------------------------------------------------------

Solver status:  1

--------------------------------------------------------------------------
So the solution definitely exists. Perhaps print_solution() is the problem.
I roll back print_solution() without the scaling, and make it print every route, even empty ones:

def print_solution(vrp_instance, num_vehicles, manager, routing, solution):
    """Prints solution on console."""
    total_distance = 0
    total_load = 0
    for vehicle_id in range(num_vehicles):
        index = routing.Start(vehicle_id)
        plan_output = 'Route for vehicle {}:\n'.format(vehicle_id)
        route_distance = 0
        route_load = 0
        while not routing.IsEnd(index):
            node_index = manager.IndexToNode(index)
            route_load += vrp_instance.get_demands()[node_index]
            plan_output += ' {0} Load({1}) -> '.format(node_index, route_load)
            previous_index = index
            index = solution.Value(routing.NextVar(index))
            route_distance += routing.GetArcCostForVehicle(
                previous_index, index, vehicle_id)
        plan_output += ' {0} Load({1})\n'.format(manager.IndexToNode(index),
                                                 route_load)
        plan_output += 'Distance of the route: {}m\n'.format(route_distance)
        plan_output += 'Load of the route: {}\n'.format(route_load)
        print(plan_output)
        total_distance += route_distance
        total_load += route_load
    print('Total distance of all routes: {}m'.format(total_distance))
    print('Total load of all routes: {}'.format(total_load))

Which gives the solution:
--------------------------------------------------------------------------

Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0
.
.
.
Route for vehicle 645:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 646:
 0 Load(0) ->  646 Load(100) ->  645 Load(200) ->  644 Load(300) ->  643 Load(350) ->  642 Load(400) ->  641 Load(450) ->  640 Load(500) ->  639 Load(550) ->  638 Load(600) ->  637 Load(700) ->  636 Load(750) ->  635 Load(850) ->  634 Load(950) ->  633 Load(1000) ->  632 Load(1100) ->  631 Load(1200) ->  630 Load(1300) ->  629 Load(1400) ->  628 Load(1500) ->  627 Load(1550) ->  626 Load(1650) ->  625 Load(1750) ->  624 Load(1850) ->  623 Load(1950) ->  622 Load(2050) ->  621 Load(2150) ->  620 Load(2250) ->  619 Load(2350) ->  618 Load(2400) ->  617 Load(2500) ->  616 Load(2550) ->  615 Load(2600) ->  614 Load(2650) ->  613 Load(2700) ->  612 Load(2750) ->  611 Load(2850) ->  610 Load(2900) ->  609 Load(2950) ->  608 Load(3000) ->  607 Load(3050) ->  606 Load(3100) ->  605 Load(3150) ->  604 Load(3200) ->  603 Load(3250) ->  602 Load(3280) ->  601 Load(3310) ->  600 Load(3410) ->  599 Load(3460) ->  598 Load(3510) ->  597 Load(3560) ->  596 Load(3610) ->  595 Load(3660) ->  594 Load(3710) ->  593 Load(3760) ->  592 Load(3810) ->  591 Load(3860) ->  590 Load(3910) ->  589 Load(4010) ->  588 Load(4110) ->  587 Load(4160) ->  586 Load(4210) ->  585 Load(4260) ->  584 Load(4310) ->  583 Load(4360) ->  582 Load(4410) ->  581 Load(4460) ->  580 Load(4510) ->  579 Load(4610) ->  578 Load(4710) ->  577 Load(4760) ->  576 Load(4860) ->  575 Load(4910) ->  574 Load(5010) ->  573 Load(5110) ->  572 Load(5160) ->  571 Load(5260) ->  570 Load(5310) ->  569 Load(5410) ->  568 Load(5460) ->  567 Load(5510) ->  566 Load(5610) ->  565 Load(5710) ->  564 Load(5760) ->  563 Load(5810) ->  562 Load(5860) ->  561 Load(5910) ->  560 Load(6010) ->  559 Load(6060) ->  558 Load(6110) ->  557 Load(6160) ->  556 Load(6210) ->  555 Load(6260) ->  554 Load(6310) ->  553 Load(6410) ->  552 Load(6460) ->  551 Load(6560) ->  550 Load(6660) ->  549 Load(6760) ->  548 Load(6810) ->  547 Load(6860) ->  546 Load(6910) ->  545 Load(7010) ->  544 Load(7040) ->  543 Load(7090) ->  542 Load(7140) ->  541 Load(7190) ->  540 Load(7240) ->  539 Load(7290) ->  538 Load(7340) ->  537 Load(7440) ->  536 Load(7490) ->  535 Load(7540) ->  534 Load(7590) ->  533 Load(7640) ->  532 Load(7740) ->  531 Load(7790) ->  530 Load(7840) ->  529 Load(7890) ->  528 Load(7990) ->  527 Load(8090) ->  526 Load(8140) ->  525 Load(8240) ->  524 Load(8340) ->  523 Load(8370) ->  522 Load(8470) ->  521 Load(8570) ->  520 Load(8620) ->  519 Load(8670) ->  518 Load(8720) ->  517 Load(8770) ->  516 Load(8820) ->  515 Load(8870) ->  514 Load(8970) ->  513 Load(9070) ->  512 Load(9100) ->  511 Load(9150) ->  510 Load(9200) ->  509 Load(9250) ->  508 Load(9300) ->  507 Load(9350) ->  506 Load(9400) ->  505 Load(9450) ->  504 Load(9500) ->  503 Load(9550) ->  502 Load(9600) ->  501 Load(9700) ->  500 Load(9750) ->  499 Load(9850) ->  498 Load(9900) ->  497 Load(9950) ->  496 Load(10000) ->  495 Load(10100) ->  494 Load(10200) ->  493 Load(10250) ->  492 Load(10300) ->  491 Load(10350) ->  490 Load(10450) ->  489 Load(10550) ->  488 Load(10650) ->  487 Load(10750) ->  486 Load(10850) ->  485 Load(10950) ->  484 Load(11050) ->  483 Load(11150) ->  482 Load(11250) ->  481 Load(11350) ->  480 Load(11450) ->  479 Load(11550) ->  478 Load(11650) ->  477 Load(11750) ->  476 Load(11850) ->  475 Load(11900) ->  474 Load(11950) ->  473 Load(12000) ->  472 Load(12050) ->  471 Load(12100) ->  470 Load(12150) ->  469 Load(12200) ->  468 Load(12250) ->  467 Load(12280) ->  466 Load(12330) ->  465 Load(12360) ->  464 Load(12410) ->  463 Load(12460) ->  462 Load(12490) ->  461 Load(12540) ->  460 Load(12640) ->  459 Load(12690) ->  458 Load(12740) ->  457 Load(12790) ->  456 Load(12840) ->  455 Load(12890) ->  454 Load(12940) ->  453 Load(12990) ->  452 Load(13090) ->  451 Load(13190) ->  450 Load(13240) ->  449 Load(13290) ->  448 Load(13340) ->  447 Load(13390) ->  446 Load(13440) ->  445 Load(13490) ->  444 Load(13540) ->  443 Load(13590) ->  442 Load(13620) ->  441 Load(13650) ->  440 Load(13700) ->  439 Load(13750) ->  438 Load(13800) ->  437 Load(13850) ->  436 Load(13900) ->  435 Load(13950) ->  434 Load(14000) ->  433 Load(14050) ->  432 Load(14100) ->  431 Load(14150) ->  430 Load(14200) ->  429 Load(14300) ->  428 Load(14400) ->  427 Load(14500) ->  426 Load(14550) ->  425 Load(14650) ->  424 Load(14750) ->  423 Load(14850) ->  422 Load(14900) ->  421 Load(14950) ->  420 Load(14980) ->  419 Load(15030) ->  418 Load(15080) ->  417 Load(15130) ->  416 Load(15180) ->  415 Load(15230) ->  414 Load(15280) ->  413 Load(15330) ->  412 Load(15380) ->  411 Load(15430) ->  410 Load(15480) ->  409 Load(15530) ->  408 Load(15630) ->  407 Load(15680) ->  406 Load(15730) ->  405 Load(15780) ->  404 Load(15830) ->  403 Load(15880) ->  402 Load(15930) ->  401 Load(15980) ->  400 Load(16080) ->  399 Load(16130) ->  398 Load(16230) ->  397 Load(16280) ->  396 Load(16380) ->  395 Load(16430) ->  394 Load(16530) ->  393 Load(16630) ->  392 Load(16730) ->  391 Load(16830) ->  390 Load(16930) ->  389 Load(17030) ->  388 Load(17130) ->  387 Load(17180) ->  386 Load(17230) ->  385 Load(17330) ->  384 Load(17380) ->  383 Load(17430) ->  382 Load(17480) ->  381 Load(17530) ->  380 Load(17630) ->  379 Load(17730) ->  378 Load(17830) ->  377 Load(17930) ->  376 Load(18030) ->  375 Load(18130) ->  374 Load(18230) ->  373 Load(18330) ->  372 Load(18380) ->  371 Load(18480) ->  370 Load(18580) ->  369 Load(18680) ->  368 Load(18780) ->  367 Load(18880) ->  366 Load(18980) ->  365 Load(19080) ->  364 Load(19180) ->  363 Load(19280) ->  362 Load(19380) ->  361 Load(19480) ->  360 Load(19580) ->  359 Load(19680) ->  358 Load(19780) ->  357 Load(19880) ->  356 Load(19980) ->  355 Load(20030) ->  354 Load(20080) ->  353 Load(20180) ->  352 Load(20230) ->  351 Load(20280) ->  350 Load(20330) ->  349 Load(20360) ->  348 Load(20460) ->  347 Load(20510) ->  346 Load(20560) ->  345 Load(20590) ->  344 Load(20690) ->  343 Load(20740) ->  342 Load(20790) ->  341 Load(20840) ->  340 Load(20940) ->  339 Load(21040) ->  338 Load(21140) ->  337 Load(21190) ->  336 Load(21240) ->  335 Load(21290) ->  334 Load(21340) ->  333 Load(21390) ->  332 Load(21440) ->  331 Load(21540) ->  330 Load(21640) ->  329 Load(21740) ->  328 Load(21790) ->  327 Load(21890) ->  326 Load(21990) ->  325 Load(22040) ->  324 Load(22090) ->  323 Load(22140) ->  322 Load(22190) ->  321 Load(22240) ->  320 Load(22340) ->  319 Load(22390) ->  318 Load(22440) ->  317 Load(22490) ->  316 Load(22540) ->  315 Load(22640) ->  314 Load(22690) ->  313 Load(22740) ->  312 Load(22790) ->  311 Load(22890) ->  310 Load(22990) ->  309 Load(23040) ->  308 Load(23140) ->  307 Load(23190) ->  306 Load(23240) ->  305 Load(23340) ->  304 Load(23440) ->  303 Load(23540) ->  302 Load(23640) ->  301 Load(23670) ->  300 Load(23770) ->  299 Load(23870) ->  298 Load(23970) ->  297 Load(24070) ->  296 Load(24120) ->  295 Load(24150) ->  294 Load(24200) ->  293 Load(24250) ->  292 Load(24280) ->  291 Load(24310) ->  290 Load(24360) ->  289 Load(24460) ->  288 Load(24560) ->  287 Load(24660) ->  286 Load(24760) ->  285 Load(24860) ->  284 Load(24960) ->  283 Load(25060) ->  282 Load(25160) ->  281 Load(25260) ->  280 Load(25360) ->  279 Load(25460) ->  278 Load(25560) ->  277 Load(25660) ->  276 Load(25760) ->  275 Load(25860) ->  274 Load(25910) ->  273 Load(26010) ->  272 Load(26060) ->  271 Load(26110) ->  270 Load(26160) ->  269 Load(26260) ->  268 Load(26360) ->  267 Load(26460) ->  266 Load(26560) ->  265 Load(26660) ->  264 Load(26760) ->  263 Load(26860) ->  262 Load(26960) ->  261 Load(27060) ->  260 Load(27160) ->  259 Load(27260) ->  258 Load(27310) ->  257 Load(27410) ->  256 Load(27510) ->  255 Load(27610) ->  254 Load(27710) ->  253 Load(27810) ->  252 Load(27910) ->  251 Load(28010) ->  250 Load(28110) ->  249 Load(28210) ->  248 Load(28310) ->  247 Load(28410) ->  246 Load(28460) ->  245 Load(28560) ->  244 Load(28660) ->  243 Load(28760) ->  242 Load(28860) ->  241 Load(28960) ->  240 Load(29060) ->  239 Load(29110) ->  238 Load(29160) ->  237 Load(29210) ->  236 Load(29260) ->  235 Load(29310) ->  234 Load(29410) ->  233 Load(29510) ->  232 Load(29610) ->  231 Load(29710) ->  230 Load(29810) ->  229 Load(29910) ->  228 Load(30010) ->  227 Load(30060) ->  226 Load(30160) ->  225 Load(30260) ->  224 Load(30360) ->  223 Load(30410) ->  222 Load(30510) ->  221 Load(30610) ->  220 Load(30710) ->  219 Load(30760) ->  218 Load(30860) ->  217 Load(30960) ->  216 Load(31010) ->  215 Load(31060) ->  214 Load(31160) ->  213 Load(31260) ->  212 Load(31310) ->  211 Load(31410) ->  210 Load(31510) ->  209 Load(31610) ->  208 Load(31710) ->  207 Load(31810) ->  206 Load(31910) ->  205 Load(32010) ->  204 Load(32110) ->  203 Load(32210) ->  202 Load(32310) ->  201 Load(32410) ->  200 Load(32510) ->  199 Load(32560) ->  198 Load(32610) ->  197 Load(32710) ->  196 Load(32810) ->  195 Load(32910) ->  194 Load(32960) ->  193 Load(33010) ->  192 Load(33060) ->  191 Load(33160) ->  190 Load(33260) ->  189 Load(33360) ->  188 Load(33460) ->  187 Load(33560) ->  186 Load(33660) ->  185 Load(33760) ->  184 Load(33860) ->  183 Load(33910) ->  182 Load(34010) ->  181 Load(34060) ->  180 Load(34110) ->  179 Load(34160) ->  178 Load(34210) ->  177 Load(34260) ->  176 Load(34310) ->  175 Load(34360) ->  174 Load(34410) ->  173 Load(34510) ->  172 Load(34610) ->  171 Load(34710) ->  170 Load(34760) ->  169 Load(34860) ->  168 Load(34960) ->  167 Load(35060) ->  166 Load(35160) ->  165 Load(35210) ->  164 Load(35260) ->  163 Load(35310) ->  162 Load(35360) ->  161 Load(35410) ->  160 Load(35460) ->  159 Load(35510) ->  158 Load(35560) ->  157 Load(35660) ->  156 Load(35710) ->  155 Load(35810) ->  154 Load(35860) ->  153 Load(35960) ->  152 Load(36060) ->  151 Load(36160) ->  150 Load(36260) ->  149 Load(36310) ->  148 Load(36410) ->  147 Load(36510) ->  146 Load(36610) ->  145 Load(36710) ->  144 Load(36810) ->  143 Load(36910) ->  142 Load(37010) ->  141 Load(37110) ->  140 Load(37210) ->  139 Load(37310) ->  138 Load(37340) ->  137 Load(37390) ->  136 Load(37490) ->  135 Load(37540) ->  134 Load(37590) ->  133 Load(37640) ->  132 Load(37690) ->  131 Load(37790) ->  130 Load(37840) ->  129 Load(37940) ->  128 Load(37990) ->  127 Load(38040) ->  126 Load(38090) ->  125 Load(38140) ->  124 Load(38190) ->  123 Load(38240) ->  122 Load(38290) ->  121 Load(38340) ->  120 Load(38390) ->  119 Load(38490) ->  118 Load(38590) ->  117 Load(38640) ->  116 Load(38740) ->  115 Load(38840) ->  114 Load(38940) ->  113 Load(39040) ->  112 Load(39140) ->  111 Load(39240) ->  110 Load(39340) ->  109 Load(39390) ->  108 Load(39440) ->  107 Load(39490) ->  106 Load(39540) ->  105 Load(39590) ->  104 Load(39640) ->  103 Load(39690) ->  102 Load(39740) ->  101 Load(39790) ->  100 Load(39840) ->  99 Load(39940) ->  98 Load(40040) ->  97 Load(40140) ->  96 Load(40190) ->  95 Load(40290) ->  94 Load(40340) ->  93 Load(40440) ->  92 Load(40490) ->  91 Load(40590) ->  90 Load(40640) ->  89 Load(40690) ->  88 Load(40790) ->  87 Load(40890) ->  86 Load(40940) ->  85 Load(41040) ->  84 Load(41140) ->  83 Load(41190) ->  82 Load(41240) ->  81 Load(41340) ->  80 Load(41440) ->  79 Load(41540) ->  78 Load(41640) ->  77 Load(41740) ->  76 Load(41840) ->  75 Load(41940) ->  74 Load(41990) ->  73 Load(42040) ->  72 Load(42140) ->  71 Load(42190) ->  70 Load(42240) ->  69 Load(42290) ->  68 Load(42340) ->  67 Load(42390) ->  66 Load(42440) ->  65 Load(42490) ->  64 Load(42520) ->  63 Load(42570) ->  62 Load(42620) ->  61 Load(42670) ->  60 Load(42720) ->  59 Load(42770) ->  58 Load(42820) ->  57 Load(42870) ->  56 Load(42920) ->  55 Load(43020) ->  54 Load(43070) ->  53 Load(43120) ->  52 Load(43170) ->  51 Load(43220) ->  50 Load(43270) ->  49 Load(43320) ->  48 Load(43370) ->  47 Load(43420) ->  46 Load(43470) ->  45 Load(43520) ->  44 Load(43570) ->  43 Load(43620) ->  42 Load(43670) ->  41 Load(43720) ->  40 Load(43770) ->  39 Load(43820) ->  38 Load(43920) ->  37 Load(43970) ->  36 Load(44020) ->  35 Load(44120) ->  34 Load(44170) ->  33 Load(44220) ->  32 Load(44320) ->  31 Load(44370) ->  30 Load(44420) ->  29 Load(44470) ->  28 Load(44520) ->  27 Load(44620) ->  26 Load(44720) ->  25 Load(44820) ->  24 Load(44920) ->  23 Load(45020) ->  22 Load(45120) ->  21 Load(45220) ->  20 Load(45270) ->  19 Load(45370) ->  18 Load(45470) ->  17 Load(45520) ->  16 Load(45570) ->  15 Load(45670) ->  14 Load(45770) ->  13 Load(45870) ->  12 Load(45970) ->  11 Load(46070) ->  10 Load(46170) ->  9 Load(46270) ->  8 Load(46370) ->  7 Load(46470) ->  6 Load(46570) ->  5 Load(46670) ->  4 Load(46770) ->  3 Load(46820) ->  2 Load(46920) ->  1 Load(47020) ->  0 Load(47020)
Distance of the route: 0m
Load of the route: 47020

Total distance of all routes: 0m
Total load of all routes: 47020

--------------------------------------------------------------------------


No wonder print_solution() didn't sprint any routes - there is only one route, and the distance for it is 0m.
Vehicle capacity is 80000, but the total load is 47020, so naturally it all got stuck in one route.
I think there is a good reason for capacity being 80000, so I'll manually change it in the main of external_data_routing.py as opposed to BOPMid_full_matrix.txt itself.
I'm going to pick an arbitrary number - let's say 10000:

    vehicle_capacity = 10000

 That should give us about 5 routes:

--------------------------------------------------------------------------

 Route for vehicle 641:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 642:
 0 Load(0) ->  98 Load(100) ->  97 Load(200) ->  96 Load(250) ->  95 Load(350) ->  94 Load(400) ->  93 Load(500) ->  92 Load(550) ->  91 Load(650) ->  90 Load(700) ->  89 Load(750) ->  88 Load(850) ->  87 Load(950) ->  86 Load(1000) ->  85 Load(1100) ->  84 Load(1200) ->  83 Load(1250) ->  82 Load(1300) ->  81 Load(1400) ->  80 Load(1500) ->  79 Load(1600) ->  78 Load(1700) ->  77 Load(1800) ->  76 Load(1900) ->  75 Load(2000) ->  74 Load(2050) ->  73 Load(2100) ->  72 Load(2200) ->  71 Load(2250) ->  70 Load(2300) ->  69 Load(2350) ->  68 Load(2400) ->  67 Load(2450) ->  66 Load(2500) ->  65 Load(2550) ->  64 Load(2580) ->  63 Load(2630) ->  62 Load(2680) ->  61 Load(2730) ->  60 Load(2780) ->  59 Load(2830) ->  58 Load(2880) ->  57 Load(2930) ->  56 Load(2980) ->  55 Load(3080) ->  54 Load(3130) ->  53 Load(3180) ->  52 Load(3230) ->  51 Load(3280) ->  50 Load(3330) ->  49 Load(3380) ->  48 Load(3430) ->  47 Load(3480) ->  46 Load(3530) ->  45 Load(3580) ->  44 Load(3630) ->  43 Load(3680) ->  42 Load(3730) ->  41 Load(3780) ->  40 Load(3830) ->  39 Load(3880) ->  38 Load(3980) ->  37 Load(4030) ->  36 Load(4080) ->  35 Load(4180) ->  34 Load(4230) ->  33 Load(4280) ->  32 Load(4380) ->  31 Load(4430) ->  30 Load(4480) ->  29 Load(4530) ->  28 Load(4580) ->  27 Load(4680) ->  26 Load(4780) ->  25 Load(4880) ->  24 Load(4980) ->  23 Load(5080) ->  22 Load(5180) ->  21 Load(5280) ->  20 Load(5330) ->  19 Load(5430) ->  18 Load(5530) ->  17 Load(5580) ->  16 Load(5630) ->  15 Load(5730) ->  14 Load(5830) ->  13 Load(5930) ->  12 Load(6030) ->  11 Load(6130) ->  10 Load(6230) ->  9 Load(6330) ->  8 Load(6430) ->  7 Load(6530) ->  6 Load(6630) ->  5 Load(6730) ->  4 Load(6830) ->  3 Load(6880) ->  2 Load(6980) ->  1 Load(7080) ->  0 Load(7080)
Distance of the route: 0m
Load of the route: 7080

Route for vehicle 643:
 0 Load(0) ->  228 Load(100) ->  226 Load(200) ->  225 Load(300) ->  224 Load(400) ->  223 Load(450) ->  222 Load(550) ->  221 Load(650) ->  220 Load(750) ->  219 Load(800) ->  218 Load(900) ->  217 Load(1000) ->  216 Load(1050) ->  215 Load(1100) ->  214 Load(1200) ->  213 Load(1300) ->  212 Load(1350) ->  211 Load(1450) ->  210 Load(1550) ->  209 Load(1650) ->  208 Load(1750) ->  207 Load(1850) ->  206 Load(1950) ->  205 Load(2050) ->  204 Load(2150) ->  203 Load(2250) ->  202 Load(2350) ->  201 Load(2450) ->  200 Load(2550) ->  199 Load(2600) ->  198 Load(2650) ->  197 Load(2750) ->  196 Load(2850) ->  195 Load(2950) ->  194 Load(3000) ->  193 Load(3050) ->  192 Load(3100) ->  191 Load(3200) ->  190 Load(3300) ->  189 Load(3400) ->  188 Load(3500) ->  187 Load(3600) ->  186 Load(3700) ->  185 Load(3800) ->  184 Load(3900) ->  183 Load(3950) ->  182 Load(4050) ->  181 Load(4100) ->  180 Load(4150) ->  179 Load(4200) ->  178 Load(4250) ->  177 Load(4300) ->  176 Load(4350) ->  175 Load(4400) ->  174 Load(4450) ->  173 Load(4550) ->  172 Load(4650) ->  171 Load(4750) ->  170 Load(4800) ->  169 Load(4900) ->  168 Load(5000) ->  167 Load(5100) ->  166 Load(5200) ->  165 Load(5250) ->  164 Load(5300) ->  163 Load(5350) ->  162 Load(5400) ->  161 Load(5450) ->  160 Load(5500) ->  159 Load(5550) ->  158 Load(5600) ->  157 Load(5700) ->  156 Load(5750) ->  155 Load(5850) ->  154 Load(5900) ->  153 Load(6000) ->  152 Load(6100) ->  151 Load(6200) ->  150 Load(6300) ->  149 Load(6350) ->  148 Load(6450) ->  147 Load(6550) ->  146 Load(6650) ->  145 Load(6750) ->  144 Load(6850) ->  143 Load(6950) ->  142 Load(7050) ->  141 Load(7150) ->  140 Load(7250) ->  139 Load(7350) ->  138 Load(7380) ->  137 Load(7430) ->  136 Load(7530) ->  135 Load(7580) ->  134 Load(7630) ->  133 Load(7680) ->  132 Load(7730) ->  131 Load(7830) ->  130 Load(7880) ->  129 Load(7980) ->  128 Load(8030) ->  127 Load(8080) ->  126 Load(8130) ->  125 Load(8180) ->  124 Load(8230) ->  123 Load(8280) ->  122 Load(8330) ->  121 Load(8380) ->  120 Load(8430) ->  119 Load(8530) ->  118 Load(8630) ->  117 Load(8680) ->  116 Load(8780) ->  115 Load(8880) ->  114 Load(8980) ->  113 Load(9080) ->  112 Load(9180) ->  111 Load(9280) ->  110 Load(9380) ->  109 Load(9430) ->  108 Load(9480) ->  107 Load(9530) ->  106 Load(9580) ->  105 Load(9630) ->  104 Load(9680) ->  103 Load(9730) ->  102 Load(9780) ->  101 Load(9830) ->  100 Load(9880) ->  99 Load(9980) ->  0 Load(9980)
Distance of the route: 0m
Load of the route: 9980

Route for vehicle 644:
 0 Load(0) ->  355 Load(50) ->  354 Load(100) ->  353 Load(200) ->  352 Load(250) ->  351 Load(300) ->  350 Load(350) ->  349 Load(380) ->  348 Load(480) ->  347 Load(530) ->  346 Load(580) ->  345 Load(610) ->  344 Load(710) ->  343 Load(760) ->  342 Load(810) ->  341 Load(860) ->  340 Load(960) ->  339 Load(1060) ->  338 Load(1160) ->  337 Load(1210) ->  336 Load(1260) ->  335 Load(1310) ->  334 Load(1360) ->  333 Load(1410) ->  332 Load(1460) ->  331 Load(1560) ->  330 Load(1660) ->  329 Load(1760) ->  328 Load(1810) ->  327 Load(1910) ->  326 Load(2010) ->  325 Load(2060) ->  324 Load(2110) ->  323 Load(2160) ->  322 Load(2210) ->  321 Load(2260) ->  320 Load(2360) ->  319 Load(2410) ->  318 Load(2460) ->  317 Load(2510) ->  316 Load(2560) ->  315 Load(2660) ->  314 Load(2710) ->  313 Load(2760) ->  312 Load(2810) ->  311 Load(2910) ->  310 Load(3010) ->  309 Load(3060) ->  308 Load(3160) ->  307 Load(3210) ->  306 Load(3260) ->  305 Load(3360) ->  304 Load(3460) ->  303 Load(3560) ->  302 Load(3660) ->  301 Load(3690) ->  300 Load(3790) ->  299 Load(3890) ->  298 Load(3990) ->  297 Load(4090) ->  296 Load(4140) ->  295 Load(4170) ->  294 Load(4220) ->  293 Load(4270) ->  292 Load(4300) ->  291 Load(4330) ->  290 Load(4380) ->  289 Load(4480) ->  288 Load(4580) ->  287 Load(4680) ->  286 Load(4780) ->  285 Load(4880) ->  284 Load(4980) ->  283 Load(5080) ->  282 Load(5180) ->  281 Load(5280) ->  280 Load(5380) ->  279 Load(5480) ->  278 Load(5580) ->  277 Load(5680) ->  276 Load(5780) ->  275 Load(5880) ->  274 Load(5930) ->  273 Load(6030) ->  272 Load(6080) ->  271 Load(6130) ->  270 Load(6180) ->  269 Load(6280) ->  268 Load(6380) ->  267 Load(6480) ->  266 Load(6580) ->  265 Load(6680) ->  264 Load(6780) ->  263 Load(6880) ->  262 Load(6980) ->  261 Load(7080) ->  260 Load(7180) ->  259 Load(7280) ->  258 Load(7330) ->  257 Load(7430) ->  256 Load(7530) ->  255 Load(7630) ->  254 Load(7730) ->  253 Load(7830) ->  252 Load(7930) ->  251 Load(8030) ->  250 Load(8130) ->  249 Load(8230) ->  248 Load(8330) ->  247 Load(8430) ->  246 Load(8480) ->  245 Load(8580) ->  244 Load(8680) ->  243 Load(8780) ->  242 Load(8880) ->  241 Load(8980) ->  240 Load(9080) ->  239 Load(9130) ->  238 Load(9180) ->  237 Load(9230) ->  236 Load(9280) ->  235 Load(9330) ->  234 Load(9430) ->  233 Load(9530) ->  232 Load(9630) ->  231 Load(9730) ->  230 Load(9830) ->  229 Load(9930) ->  227 Load(9980) ->  0 Load(9980)
Distance of the route: 0m
Load of the route: 9980

Route for vehicle 645:
 0 Load(0) ->  495 Load(100) ->  494 Load(200) ->  493 Load(250) ->  492 Load(300) ->  491 Load(350) ->  490 Load(450) ->  489 Load(550) ->  488 Load(650) ->  487 Load(750) ->  486 Load(850) ->  485 Load(950) ->  484 Load(1050) ->  483 Load(1150) ->  482 Load(1250) ->  481 Load(1350) ->  480 Load(1450) ->  479 Load(1550) ->  478 Load(1650) ->  477 Load(1750) ->  476 Load(1850) ->  475 Load(1900) ->  474 Load(1950) ->  473 Load(2000) ->  472 Load(2050) ->  471 Load(2100) ->  470 Load(2150) ->  469 Load(2200) ->  468 Load(2250) ->  467 Load(2280) ->  466 Load(2330) ->  465 Load(2360) ->  464 Load(2410) ->  463 Load(2460) ->  462 Load(2490) ->  461 Load(2540) ->  460 Load(2640) ->  459 Load(2690) ->  458 Load(2740) ->  457 Load(2790) ->  456 Load(2840) ->  455 Load(2890) ->  454 Load(2940) ->  453 Load(2990) ->  452 Load(3090) ->  451 Load(3190) ->  450 Load(3240) ->  449 Load(3290) ->  448 Load(3340) ->  447 Load(3390) ->  446 Load(3440) ->  445 Load(3490) ->  444 Load(3540) ->  443 Load(3590) ->  442 Load(3620) ->  441 Load(3650) ->  440 Load(3700) ->  439 Load(3750) ->  438 Load(3800) ->  437 Load(3850) ->  436 Load(3900) ->  435 Load(3950) ->  434 Load(4000) ->  433 Load(4050) ->  432 Load(4100) ->  431 Load(4150) ->  430 Load(4200) ->  429 Load(4300) ->  428 Load(4400) ->  427 Load(4500) ->  426 Load(4550) ->  425 Load(4650) ->  424 Load(4750) ->  423 Load(4850) ->  422 Load(4900) ->  421 Load(4950) ->  420 Load(4980) ->  419 Load(5030) ->  418 Load(5080) ->  417 Load(5130) ->  416 Load(5180) ->  415 Load(5230) ->  414 Load(5280) ->  413 Load(5330) ->  412 Load(5380) ->  411 Load(5430) ->  410 Load(5480) ->  409 Load(5530) ->  408 Load(5630) ->  407 Load(5680) ->  406 Load(5730) ->  405 Load(5780) ->  404 Load(5830) ->  403 Load(5880) ->  402 Load(5930) ->  401 Load(5980) ->  400 Load(6080) ->  399 Load(6130) ->  398 Load(6230) ->  397 Load(6280) ->  396 Load(6380) ->  395 Load(6430) ->  394 Load(6530) ->  393 Load(6630) ->  392 Load(6730) ->  391 Load(6830) ->  390 Load(6930) ->  389 Load(7030) ->  388 Load(7130) ->  387 Load(7180) ->  386 Load(7230) ->  385 Load(7330) ->  384 Load(7380) ->  383 Load(7430) ->  382 Load(7480) ->  381 Load(7530) ->  380 Load(7630) ->  379 Load(7730) ->  378 Load(7830) ->  377 Load(7930) ->  376 Load(8030) ->  375 Load(8130) ->  374 Load(8230) ->  373 Load(8330) ->  372 Load(8380) ->  371 Load(8480) ->  370 Load(8580) ->  369 Load(8680) ->  368 Load(8780) ->  367 Load(8880) ->  366 Load(8980) ->  365 Load(9080) ->  364 Load(9180) ->  363 Load(9280) ->  362 Load(9380) ->  361 Load(9480) ->  360 Load(9580) ->  359 Load(9680) ->  358 Load(9780) ->  357 Load(9880) ->  356 Load(9980) ->  0 Load(9980)
Distance of the route: 0m
Load of the route: 9980

Route for vehicle 646:
 0 Load(0) ->  646 Load(100) ->  645 Load(200) ->  644 Load(300) ->  643 Load(350) ->  642 Load(400) ->  641 Load(450) ->  640 Load(500) ->  639 Load(550) ->  638 Load(600) ->  637 Load(700) ->  636 Load(750) ->  635 Load(850) ->  634 Load(950) ->  633 Load(1000) ->  632 Load(1100) ->  631 Load(1200) ->  630 Load(1300) ->  629 Load(1400) ->  628 Load(1500) ->  627 Load(1550) ->  626 Load(1650) ->  625 Load(1750) ->  624 Load(1850) ->  623 Load(1950) ->  622 Load(2050) ->  621 Load(2150) ->  620 Load(2250) ->  619 Load(2350) ->  618 Load(2400) ->  617 Load(2500) ->  616 Load(2550) ->  615 Load(2600) ->  614 Load(2650) ->  613 Load(2700) ->  612 Load(2750) ->  611 Load(2850) ->  610 Load(2900) ->  609 Load(2950) ->  608 Load(3000) ->  607 Load(3050) ->  606 Load(3100) ->  605 Load(3150) ->  604 Load(3200) ->  603 Load(3250) ->  602 Load(3280) ->  601 Load(3310) ->  600 Load(3410) ->  599 Load(3460) ->  598 Load(3510) ->  597 Load(3560) ->  596 Load(3610) ->  595 Load(3660) ->  594 Load(3710) ->  593 Load(3760) ->  592 Load(3810) ->  591 Load(3860) ->  590 Load(3910) ->  589 Load(4010) ->  588 Load(4110) ->  587 Load(4160) ->  586 Load(4210) ->  585 Load(4260) ->  584 Load(4310) ->  583 Load(4360) ->  582 Load(4410) ->  581 Load(4460) ->  580 Load(4510) ->  579 Load(4610) ->  578 Load(4710) ->  577 Load(4760) ->  576 Load(4860) ->  575 Load(4910) ->  574 Load(5010) ->  573 Load(5110) ->  572 Load(5160) ->  571 Load(5260) ->  570 Load(5310) ->  569 Load(5410) ->  568 Load(5460) ->  567 Load(5510) ->  566 Load(5610) ->  565 Load(5710) ->  564 Load(5760) ->  563 Load(5810) ->  562 Load(5860) ->  561 Load(5910) ->  560 Load(6010) ->  559 Load(6060) ->  558 Load(6110) ->  557 Load(6160) ->  556 Load(6210) ->  555 Load(6260) ->  554 Load(6310) ->  553 Load(6410) ->  552 Load(6460) ->  551 Load(6560) ->  550 Load(6660) ->  549 Load(6760) ->  548 Load(6810) ->  547 Load(6860) ->  546 Load(6910) ->  545 Load(7010) ->  544 Load(7040) ->  543 Load(7090) ->  542 Load(7140) ->  541 Load(7190) ->  540 Load(7240) ->  539 Load(7290) ->  538 Load(7340) ->  537 Load(7440) ->  536 Load(7490) ->  535 Load(7540) ->  534 Load(7590) ->  533 Load(7640) ->  532 Load(7740) ->  531 Load(7790) ->  530 Load(7840) ->  529 Load(7890) ->  528 Load(7990) ->  527 Load(8090) ->  526 Load(8140) ->  525 Load(8240) ->  524 Load(8340) ->  523 Load(8370) ->  522 Load(8470) ->  521 Load(8570) ->  520 Load(8620) ->  519 Load(8670) ->  518 Load(8720) ->  517 Load(8770) ->  516 Load(8820) ->  515 Load(8870) ->  514 Load(8970) ->  513 Load(9070) ->  512 Load(9100) ->  511 Load(9150) ->  510 Load(9200) ->  509 Load(9250) ->  508 Load(9300) ->  507 Load(9350) ->  506 Load(9400) ->  505 Load(9450) ->  504 Load(9500) ->  503 Load(9550) ->  502 Load(9600) ->  501 Load(9700) ->  500 Load(9750) ->  499 Load(9850) ->  498 Load(9900) ->  497 Load(9950) ->  496 Load(10000) ->  0 Load(10000)
Distance of the route: 0m
Load of the route: 10000

Total distance of all routes: 0m
Total load of all routes: 47020
[Finished in 5.122s]

--------------------------------------------------------------------------

Yup, or-tools is splitting up the routes properly, but still not showing the distances.

Last time there was this issue, it was because the distance callback weren't feeding zeroes as the distance between a node & itself.
But I haven't modified the distance_callback() since then!
The distance_callback pulls distances directly from vrp_instance.arcs.
arcs seems to load up fine, though.

Let's have a look at what values the distance callback is passing:

def distance_callback(from_index, to_index):
      from_node = manager.IndexToNode(from_index)
      to_node = manager.IndexToNode(to_index)
      if from_node == to_node:
          distance = 0
          print("from_node = to_node, distance 0")
      else:
          distance = (vrp_instance.arcs[from_node][to_node]).distance
          distance = round(distance * 1000)
          print("extracted from arcs, distance" + distance)

      return distance

It should be all arc values.
--------------------------------------------------------------------------

name = BOPMid_full_matrix
Vehicle.capacity = 80000
Vehicle.variable_cost = 0.8
Depot.id = 0
Depot.location = [0, 0]
nodes in instance, including depot: 647
arcs in instance: 417962
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
.
.
.
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
Solver status:  1

--------------------------------------------------------------------------


Uh-oh. All zeros.
Is from_node == to_node ??

Let's load up a different vrp instance to check if this is expected behaviour:

    vrp_instance = import_vrp_instance_from_file("C:/Users/jc321076/github/VRPModeling/Andersen_n8.vrp")

Now:
--------------------------------------------------------------------------

NAME : Andersen_n8

TYPE : CVRP

DIMENSION : 8

EDGE_WEIGHT_TYPE : EUC_2D

CAPACITY : 30

DEMAND_SECTION

Node at location [10, 4] could not be added because demand 45 is greater than vehicle capacity 30
Node at location [1, 1] could not be added because demand 35 is greater than vehicle capacity 30
name = Andersen_n8
Vehicle.capacity = 30
Vehicle.variable_cost = 0.8
Depot.id = 0
Depot.location = [0, 0]
nodes in instance, including depot: 6
arcs in instance: 30
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
from_node = to_node, distance 0
Solver status:  1
Route for vehicle 0:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 1:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 2:
 0 Load(0) ->  0 Load(0)
Distance of the route: 0m
Load of the route: 0

Route for vehicle 3:
 0 Load(0) ->  3 Load(15) ->  2 Load(30) ->  0 Load(30)
Distance of the route: 0m
Load of the route: 30

Route for vehicle 4:
 0 Load(0) ->  4 Load(20) ->  0 Load(20)
Distance of the route: 0m
Load of the route: 20

Route for vehicle 5:
 0 Load(0) ->  5 Load(25) ->  1 Load(30) ->  0 Load(30)
Distance of the route: 0m
Load of the route: 30

Total distance of all routes: 0m
Total load of all routes: 80
[Finished in 0.422s]

--------------------------------------------------------------------------


Huh. Same behaviour. Not good.
Okay so this is the last known distance matrix for Andersen_n8.vrp:

[[ 0.          5.38516481  1.          5.09901951  8.54400375  6.08276253  3.16227766 10.        ]
 [ 5.38516481  0.          5.09901951  5.          3.16227766  5.65685425  4.12310563  5.        ]
 [ 1.          5.09901951  0.          4.12310563  8.24621125  5.09901951  2.23606798  9.43398113]
 [ 5.09901951  5.          4.12310563  0.          7.28010989  1.          2.          7.07106781]
 [ 8.54400375  3.16227766  8.24621125  7.28010989  0.          7.61577311  7.          3.        ]
 [ 6.08276253  5.65685425  5.09901951  1.          7.61577311  0.          3.          7.        ]
 [ 3.16227766  4.12310563  2.23606798  2.          7.          3.          0.          7.61577311]
 [10.          5.          9.43398113  7.07106781  3.          7.          7.61577311  0.        ]]

 And here is what the current one spits out:
--------------------------------------------------------------------------

[[ 0.         13.92838828  9.8488578   1.          8.54400375 10.77032961]
 [13.92838828  0.          9.8488578  13.60147051 10.44030651  3.16227766]
 [ 9.8488578   9.8488578   0.          8.94427191  1.41421356  7.81024968]
 [ 1.         13.60147051  8.94427191  0.          7.61577311 10.44030651]
 [ 8.54400375 10.44030651  1.41421356  7.61577311  0.          8.06225775]
 [10.77032961  3.16227766  7.81024968 10.44030651  8.06225775  0.        ]]

--------------------------------------------------------------------------


Why are they different?
The names, dimensions, node locations and demands are the same.
Just the arc distances are playing up.
I suspect FileProcessor.import_from_vrp_file().

    if line.startswith('EDGE_WEIGHT_SECTION'):
        print("EDGE_WEIGHT_SECTION true")

Okay, it didn't print, so the next area of suspect is:
    if is_weighted:
        print(weighted_distances)
        for i in range(dimension - 1):
            # print("i val: ", i)
            # print(nodes_coords[i], demands[i], weighted_distances[i])
            vrp_instance.add_node(nodes_coords[i], demands[i], weighted_distances[i])
    else:
        print("is_weighted is false")
        for i in range(dimension - 1):
            vrp_instance.add_node(nodes_coords[i], demands[i])

Okay, it did print "is_weighted is false".
The next section of suspect is vrp_instance.add_node():

    if arc_distances is None:
              print("arc creation reached")
              for existing_node in self.nodes:
                  # Arc will calculate distance using node locations
                  new_arc = Arc(existing_node, new_node)
                  new_arc_sym = Arc(new_node, existing_node)
                  self.arcs[new_arc.origin.id][new_arc.destination.id] = new_arc
                  self.arcs[new_arc.destination.id][new_arc.origin.id] = new_arc_sym
    else:  # arc_distances inputted
        for existing_node in self.nodes:
            new_arc = Arc(existing_node, new_node, arc_distances[existing_node.id])
            new_arc_sym = Arc(new_node, existing_node, arc_distances[existing_node.id])
            # print(new_arc.__str__())
            self.arcs[new_arc.origin.id][new_arc.destination.id] = new_arc
            self.arcs[new_arc.destination.id][new_arc.origin.id] = new_arc_sym

Okay, it printed "arc creation reached" five times, as expected.
The next section of suspect is Arc() itself:

    def __init__(self, origin, destination, distance=None):
        self.origin = origin
        self.destination = destination
        if distance is None:
            print("distance is indeed None")
            self.distance = self.get_distance()
        else:
            self.distance = distance

Okay, it printed "distance is indeed None" appropriately....
So what is wrong? Let me double check the distance matrix...
--------------------------------------------------------------------------
--------------------------------------------------------------------------
--------------------------------------------------------------------------
--------------------------------------------------------------------------
Is it due to non-Euclidean distances? Or high vehicle capacity?
Or that some nodes are only connected to a few other nodes?

No, I know that the weed instance was logged as solved in get_capacitated_weed_instance_working_tests.txt.
Whatever is producing this problem is either due to VRPModeling, or anything I've modified in external_data_routing.py
